{"ast":null,"code":"\"use strict\";\n\nvar __assign = this && this.__assign || function () {\n  __assign = Object.assign || function (t) {\n    for (var s, i = 1, n = arguments.length; i < n; i++) {\n      s = arguments[i];\n      for (var p in s) if (Object.prototype.hasOwnProperty.call(s, p)) t[p] = s[p];\n    }\n    return t;\n  };\n  return __assign.apply(this, arguments);\n};\nvar __awaiter = this && this.__awaiter || function (thisArg, _arguments, P, generator) {\n  function adopt(value) {\n    return value instanceof P ? value : new P(function (resolve) {\n      resolve(value);\n    });\n  }\n  return new (P || (P = Promise))(function (resolve, reject) {\n    function fulfilled(value) {\n      try {\n        step(generator.next(value));\n      } catch (e) {\n        reject(e);\n      }\n    }\n    function rejected(value) {\n      try {\n        step(generator[\"throw\"](value));\n      } catch (e) {\n        reject(e);\n      }\n    }\n    function step(result) {\n      result.done ? resolve(result.value) : adopt(result.value).then(fulfilled, rejected);\n    }\n    step((generator = generator.apply(thisArg, _arguments || [])).next());\n  });\n};\nvar __generator = this && this.__generator || function (thisArg, body) {\n  var _ = {\n      label: 0,\n      sent: function () {\n        if (t[0] & 1) throw t[1];\n        return t[1];\n      },\n      trys: [],\n      ops: []\n    },\n    f,\n    y,\n    t,\n    g;\n  return g = {\n    next: verb(0),\n    throw: verb(1),\n    return: verb(2)\n  }, typeof Symbol === \"function\" && (g[Symbol.iterator] = function () {\n    return this;\n  }), g;\n  function verb(n) {\n    return function (v) {\n      return step([n, v]);\n    };\n  }\n  function step(op) {\n    if (f) throw new TypeError(\"Generator is already executing.\");\n    while (_) try {\n      if (f = 1, y && (t = op[0] & 2 ? y[\"return\"] : op[0] ? y[\"throw\"] || ((t = y[\"return\"]) && t.call(y), 0) : y.next) && !(t = t.call(y, op[1])).done) return t;\n      if (y = 0, t) op = [op[0] & 2, t.value];\n      switch (op[0]) {\n        case 0:\n        case 1:\n          t = op;\n          break;\n        case 4:\n          _.label++;\n          return {\n            value: op[1],\n            done: false\n          };\n        case 5:\n          _.label++;\n          y = op[1];\n          op = [0];\n          continue;\n        case 7:\n          op = _.ops.pop();\n          _.trys.pop();\n          continue;\n        default:\n          if (!(t = _.trys, t = t.length > 0 && t[t.length - 1]) && (op[0] === 6 || op[0] === 2)) {\n            _ = 0;\n            continue;\n          }\n          if (op[0] === 3 && (!t || op[1] > t[0] && op[1] < t[3])) {\n            _.label = op[1];\n            break;\n          }\n          if (op[0] === 6 && _.label < t[1]) {\n            _.label = t[1];\n            t = op;\n            break;\n          }\n          if (t && _.label < t[2]) {\n            _.label = t[2];\n            _.ops.push(op);\n            break;\n          }\n          if (t[2]) _.ops.pop();\n          _.trys.pop();\n          continue;\n      }\n      op = body.call(thisArg, _);\n    } catch (e) {\n      op = [6, e];\n      y = 0;\n    } finally {\n      f = t = 0;\n    }\n    if (op[0] & 5) throw op[1];\n    return {\n      value: op[0] ? op[1] : void 0,\n      done: true\n    };\n  }\n};\nvar __rest = this && this.__rest || function (s, e) {\n  var t = {};\n  for (var p in s) if (Object.prototype.hasOwnProperty.call(s, p) && e.indexOf(p) < 0) t[p] = s[p];\n  if (s != null && typeof Object.getOwnPropertySymbols === \"function\") for (var i = 0, p = Object.getOwnPropertySymbols(s); i < p.length; i++) {\n    if (e.indexOf(p[i]) < 0 && Object.prototype.propertyIsEnumerable.call(s, p[i])) t[p[i]] = s[p[i]];\n  }\n  return t;\n};\nvar __importDefault = this && this.__importDefault || function (mod) {\n  return mod && mod.__esModule ? mod : {\n    default: mod\n  };\n};\nObject.defineProperty(exports, \"__esModule\", {\n  value: true\n});\nvar jsx_runtime_1 = require(\"@emotion/react/jsx-runtime\");\n/* Copyright (c) 2021, VRAI Labs and/or its affiliates. All rights reserved.\n *\n * This software is licensed under the Apache License, Version 2.0 (the\n * \"License\") as published by the Apache Software Foundation.\n *\n * You may not use this file except in compliance with the License. You may\n * obtain a copy of the License at http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS, WITHOUT\n * WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied. See the\n * License for the specific language governing permissions and limitations\n * under the License.\n */\n/*\n * Imports.\n */\nvar react_1 = require(\"react\");\nvar sessionContext_1 = __importDefault(require(\"./sessionContext\"));\nvar recipe_1 = __importDefault(require(\"./recipe\"));\nvar usercontext_1 = require(\"../../usercontext\");\nvar userContextWrapper_1 = __importDefault(require(\"../../usercontext/userContextWrapper\"));\nvar utils_1 = require(\"../../utils\");\nvar superTokens_1 = __importDefault(require(\"../../superTokens\"));\nvar SessionAuth = function (_a) {\n  var _b;\n  var children = _a.children,\n    props = __rest(_a, [\"children\"]);\n  var requireAuth = (0, react_1.useRef)(props.requireAuth);\n  if (props.requireAuth !== requireAuth.current) {\n    throw new Error(\n    // eslint-disable-next-line @typescript-eslint/quotes\n    'requireAuth prop should not change. If you are seeing this, it probably means that you are using SessionAuth in multiple routes with different values for requireAuth. To solve this, try adding the \"key\" prop to all uses of SessionAuth like <SessionAuth key=\"someUniqueKeyPerRoute\" requireAuth={...}>');\n  }\n  // Reusing the parent context was removed because it caused a redirect loop in an edge case\n  // because it'd also reuse the invalid claims part until it loaded.\n  var _c = (0, react_1.useState)({\n      loading: true\n    }),\n    context = _c[0],\n    setContext = _c[1];\n  var session = (0, react_1.useRef)();\n  // We store this here, to prevent the list of called hooks changing even if a history hook is added later to SuperTokens.\n  var historyHookRef = (0, react_1.useRef)((_b = superTokens_1.default.getReactRouterDomWithCustomHistory()) === null || _b === void 0 ? void 0 : _b.useHistoryCustom);\n  var history;\n  try {\n    if (historyHookRef.current) {\n      history = historyHookRef.current();\n    }\n  } catch (_d) {\n    // We catch and ignore errors here, because if this is may throw if\n    // the app is using react-router-dom but added a session auth outside of the router.\n  }\n  var userContext = (0, usercontext_1.useUserContext)();\n  var redirectToLogin = (0, react_1.useCallback)(function () {\n    void superTokens_1.default.getInstanceOrThrow().redirectToAuth({\n      history: history,\n      redirectBack: true\n    });\n  }, []);\n  var buildContext = (0, react_1.useCallback)(function () {\n    return __awaiter(void 0, void 0, void 0, function () {\n      var sessionExists, invalidClaims, err_1, invalidClaimRedirectToPath, err_2;\n      var _a;\n      return __generator(this, function (_b) {\n        switch (_b.label) {\n          case 0:\n            if (session.current === undefined) {\n              session.current = recipe_1.default.getInstanceOrThrow();\n            }\n            return [4 /*yield*/, session.current.doesSessionExist({\n              userContext: userContext\n            })];\n          case 1:\n            sessionExists = _b.sent();\n            if (sessionExists === false) {\n              return [2 /*return*/, {\n                loading: false,\n                doesSessionExist: false,\n                accessTokenPayload: {},\n                invalidClaims: [],\n                userId: \"\"\n              }];\n            }\n            _b.label = 2;\n          case 2:\n            _b.trys.push([2, 4,, 6]);\n            return [4 /*yield*/, session.current.validateClaims({\n              overrideGlobalClaimValidators: props.overrideGlobalClaimValidators,\n              userContext: userContext\n            })];\n          case 3:\n            invalidClaims = _b.sent();\n            return [3 /*break*/, 6];\n          case 4:\n            err_1 = _b.sent();\n            return [4 /*yield*/, session.current.doesSessionExist({\n              userContext: userContext\n            })];\n          case 5:\n            // These errors should only come from getAccessTokenPayloadSecurely inside validateClaims if refreshing a claim cleared the session\n            // Which means that the session was most likely cleared, meaning returning false is right.\n            // This might also happen if the user provides an override or a custom claim validator that throws (or if we have a bug)\n            // In which case the session will not be cleared so we rethrow the error\n            if (_b.sent()) {\n              throw err_1;\n            }\n            return [2 /*return*/, {\n              loading: false,\n              doesSessionExist: false,\n              accessTokenPayload: {},\n              invalidClaims: [],\n              userId: \"\"\n            }];\n          case 6:\n            invalidClaimRedirectToPath = (0, utils_1.popInvalidClaimRedirectPathFromContext)(userContext);\n            _b.label = 7;\n          case 7:\n            _b.trys.push([7, 10,, 12]);\n            _a = {\n              loading: false,\n              doesSessionExist: true,\n              invalidClaims: invalidClaims,\n              invalidClaimRedirectToPath: invalidClaimRedirectToPath\n            };\n            return [4 /*yield*/, session.current.getAccessTokenPayloadSecurely({\n              userContext: userContext\n            })];\n          case 8:\n            _a.accessTokenPayload = _b.sent();\n            return [4 /*yield*/, session.current.getUserId({\n              userContext: userContext\n            })];\n          case 9:\n            return [2 /*return*/, (_a.userId = _b.sent(), _a)];\n          case 10:\n            err_2 = _b.sent();\n            return [4 /*yield*/, session.current.doesSessionExist({\n              userContext: userContext\n            })];\n          case 11:\n            if (_b.sent()) {\n              throw err_2;\n            }\n            // This means that loading the access token or the userId failed\n            // This may happen if the server cleared the error since the validation was done which should be extremely rare\n            return [2 /*return*/, {\n              loading: false,\n              doesSessionExist: false,\n              accessTokenPayload: {},\n              invalidClaims: [],\n              userId: \"\"\n            }];\n          case 12:\n            return [2 /*return*/];\n        }\n      });\n    });\n  }, []);\n  var setInitialContextAndMaybeRedirect = (0, react_1.useCallback)(function (toSetContext) {\n    return __awaiter(void 0, void 0, void 0, function () {\n      return __generator(this, function (_a) {\n        switch (_a.label) {\n          case 0:\n            if (context.loading === false) {\n              return [2 /*return*/];\n            }\n\n            if (!(props.doRedirection !== false)) return [3 /*break*/, 3];\n            if (!(!toSetContext.doesSessionExist && props.requireAuth !== false)) return [3 /*break*/, 1];\n            redirectToLogin();\n            return [2 /*return*/];\n          case 1:\n            if (!(toSetContext.invalidClaimRedirectToPath !== undefined)) return [3 /*break*/, 3];\n            return [4 /*yield*/, superTokens_1.default.getInstanceOrThrow().redirectToUrl(toSetContext.invalidClaimRedirectToPath, history)];\n          case 2:\n            _a.sent();\n            return [2 /*return*/];\n          case 3:\n            delete toSetContext.invalidClaimRedirectToPath;\n            setContext(toSetContext);\n            return [2 /*return*/];\n        }\n      });\n    });\n  }, [props.doRedirection, props.requireAuth, redirectToLogin, context]);\n  (0, utils_1.useOnMountAPICall)(buildContext, setInitialContextAndMaybeRedirect);\n  // subscribe to events on mount\n  (0, react_1.useEffect)(function () {\n    function onHandleEvent(event) {\n      return __awaiter(this, void 0, void 0, function () {\n        var _a, invalidClaims, redirectPath;\n        return __generator(this, function (_b) {\n          switch (_b.label) {\n            case 0:\n              _a = event.action;\n              switch (_a) {\n                case \"SESSION_CREATED\":\n                  return [3 /*break*/, 1];\n                case \"REFRESH_SESSION\":\n                  return [3 /*break*/, 1];\n                case \"ACCESS_TOKEN_PAYLOAD_UPDATED\":\n                  return [3 /*break*/, 1];\n                case \"API_INVALID_CLAIM\":\n                  return [3 /*break*/, 1];\n                case \"SIGN_OUT\":\n                  return [3 /*break*/, 5];\n                case \"UNAUTHORISED\":\n                  return [3 /*break*/, 6];\n              }\n              return [3 /*break*/, 7];\n            case 1:\n              return [4 /*yield*/, session.current.validateClaims({\n                overrideGlobalClaimValidators: props.overrideGlobalClaimValidators,\n                userContext: userContext\n              })];\n            case 2:\n              invalidClaims = _b.sent();\n              setContext(__assign(__assign({}, event.sessionContext), {\n                loading: false,\n                invalidClaims: invalidClaims\n              }));\n              redirectPath = (0, utils_1.popInvalidClaimRedirectPathFromContext)(userContext);\n              if (!(props.doRedirection !== false && redirectPath)) return [3 /*break*/, 4];\n              return [4 /*yield*/, superTokens_1.default.getInstanceOrThrow().redirectToUrl(redirectPath, history)];\n            case 3:\n              _b.sent();\n              _b.label = 4;\n            case 4:\n              return [2 /*return*/];\n            case 5:\n              setContext(__assign(__assign({}, event.sessionContext), {\n                loading: false,\n                invalidClaims: []\n              }));\n              return [2 /*return*/];\n            case 6:\n              setContext(__assign(__assign({}, event.sessionContext), {\n                loading: false,\n                invalidClaims: []\n              }));\n              if (props.onSessionExpired !== undefined) {\n                props.onSessionExpired();\n              } else if (props.requireAuth !== false && props.doRedirection !== false) {\n                redirectToLogin();\n              }\n              return [2 /*return*/];\n            case 7:\n              return [2 /*return*/];\n          }\n        });\n      });\n    }\n\n    if (session.current === undefined) {\n      session.current = recipe_1.default.getInstanceOrThrow();\n    }\n    if (context.loading === false) {\n      // we return here cause addEventListener returns a function that removes\n      // the listener, and this function will be called by useEffect when\n      // onHandleEvent changes or if the component is unmounting.\n      return session.current.addEventListener(onHandleEvent);\n    }\n    return undefined;\n  }, [props, setContext, context.loading]);\n  if (props.requireAuth !== false && (context.loading || !context.doesSessionExist)) {\n    return null;\n  }\n  return (0, jsx_runtime_1.jsx)(sessionContext_1.default.Provider, __assign({\n    value: context\n  }, {\n    children: children\n  }));\n};\nvar SessionAuthWrapper = function (props) {\n  return (0, jsx_runtime_1.jsx)(userContextWrapper_1.default, __assign({\n    userContext: props.userContext\n  }, {\n    children: (0, jsx_runtime_1.jsx)(SessionAuth, __assign({}, props))\n  }));\n};\nexports.default = SessionAuthWrapper;","map":{"version":3,"names":["__assign","Object","assign","t","s","i","n","arguments","length","p","prototype","hasOwnProperty","call","apply","__awaiter","thisArg","_arguments","P","generator","adopt","value","resolve","Promise","reject","fulfilled","step","next","e","rejected","result","done","then","__generator","body","_","label","sent","trys","ops","f","y","g","verb","throw","return","Symbol","iterator","v","op","TypeError","pop","push","__rest","indexOf","getOwnPropertySymbols","propertyIsEnumerable","__importDefault","mod","__esModule","default","defineProperty","exports","jsx_runtime_1","require","react_1","sessionContext_1","recipe_1","usercontext_1","userContextWrapper_1","utils_1","superTokens_1","SessionAuth","_a","_b","children","props","requireAuth","useRef","current","Error","_c","useState","loading","context","setContext","session","historyHookRef","getReactRouterDomWithCustomHistory","useHistoryCustom","history","_d","userContext","useUserContext","redirectToLogin","useCallback","getInstanceOrThrow","redirectToAuth","redirectBack","buildContext","sessionExists","invalidClaims","err_1","invalidClaimRedirectToPath","err_2","undefined","doesSessionExist","accessTokenPayload","userId","validateClaims","overrideGlobalClaimValidators","popInvalidClaimRedirectPathFromContext","getAccessTokenPayloadSecurely","getUserId","setInitialContextAndMaybeRedirect","toSetContext","doRedirection","redirectToUrl","useOnMountAPICall","useEffect","onHandleEvent","event","redirectPath","action","sessionContext","onSessionExpired","addEventListener","jsx","Provider","SessionAuthWrapper"],"sources":["C:/Users/jsierra/puntodelaguaapp/frontend/node_modules/supertokens-auth-react/lib/build/recipe/session/sessionAuth.js"],"sourcesContent":["\"use strict\";\nvar __assign =\n    (this && this.__assign) ||\n    function () {\n        __assign =\n            Object.assign ||\n            function (t) {\n                for (var s, i = 1, n = arguments.length; i < n; i++) {\n                    s = arguments[i];\n                    for (var p in s) if (Object.prototype.hasOwnProperty.call(s, p)) t[p] = s[p];\n                }\n                return t;\n            };\n        return __assign.apply(this, arguments);\n    };\nvar __awaiter =\n    (this && this.__awaiter) ||\n    function (thisArg, _arguments, P, generator) {\n        function adopt(value) {\n            return value instanceof P\n                ? value\n                : new P(function (resolve) {\n                      resolve(value);\n                  });\n        }\n        return new (P || (P = Promise))(function (resolve, reject) {\n            function fulfilled(value) {\n                try {\n                    step(generator.next(value));\n                } catch (e) {\n                    reject(e);\n                }\n            }\n            function rejected(value) {\n                try {\n                    step(generator[\"throw\"](value));\n                } catch (e) {\n                    reject(e);\n                }\n            }\n            function step(result) {\n                result.done ? resolve(result.value) : adopt(result.value).then(fulfilled, rejected);\n            }\n            step((generator = generator.apply(thisArg, _arguments || [])).next());\n        });\n    };\nvar __generator =\n    (this && this.__generator) ||\n    function (thisArg, body) {\n        var _ = {\n                label: 0,\n                sent: function () {\n                    if (t[0] & 1) throw t[1];\n                    return t[1];\n                },\n                trys: [],\n                ops: [],\n            },\n            f,\n            y,\n            t,\n            g;\n        return (\n            (g = { next: verb(0), throw: verb(1), return: verb(2) }),\n            typeof Symbol === \"function\" &&\n                (g[Symbol.iterator] = function () {\n                    return this;\n                }),\n            g\n        );\n        function verb(n) {\n            return function (v) {\n                return step([n, v]);\n            };\n        }\n        function step(op) {\n            if (f) throw new TypeError(\"Generator is already executing.\");\n            while (_)\n                try {\n                    if (\n                        ((f = 1),\n                        y &&\n                            (t =\n                                op[0] & 2\n                                    ? y[\"return\"]\n                                    : op[0]\n                                    ? y[\"throw\"] || ((t = y[\"return\"]) && t.call(y), 0)\n                                    : y.next) &&\n                            !(t = t.call(y, op[1])).done)\n                    )\n                        return t;\n                    if (((y = 0), t)) op = [op[0] & 2, t.value];\n                    switch (op[0]) {\n                        case 0:\n                        case 1:\n                            t = op;\n                            break;\n                        case 4:\n                            _.label++;\n                            return { value: op[1], done: false };\n                        case 5:\n                            _.label++;\n                            y = op[1];\n                            op = [0];\n                            continue;\n                        case 7:\n                            op = _.ops.pop();\n                            _.trys.pop();\n                            continue;\n                        default:\n                            if (\n                                !((t = _.trys), (t = t.length > 0 && t[t.length - 1])) &&\n                                (op[0] === 6 || op[0] === 2)\n                            ) {\n                                _ = 0;\n                                continue;\n                            }\n                            if (op[0] === 3 && (!t || (op[1] > t[0] && op[1] < t[3]))) {\n                                _.label = op[1];\n                                break;\n                            }\n                            if (op[0] === 6 && _.label < t[1]) {\n                                _.label = t[1];\n                                t = op;\n                                break;\n                            }\n                            if (t && _.label < t[2]) {\n                                _.label = t[2];\n                                _.ops.push(op);\n                                break;\n                            }\n                            if (t[2]) _.ops.pop();\n                            _.trys.pop();\n                            continue;\n                    }\n                    op = body.call(thisArg, _);\n                } catch (e) {\n                    op = [6, e];\n                    y = 0;\n                } finally {\n                    f = t = 0;\n                }\n            if (op[0] & 5) throw op[1];\n            return { value: op[0] ? op[1] : void 0, done: true };\n        }\n    };\nvar __rest =\n    (this && this.__rest) ||\n    function (s, e) {\n        var t = {};\n        for (var p in s) if (Object.prototype.hasOwnProperty.call(s, p) && e.indexOf(p) < 0) t[p] = s[p];\n        if (s != null && typeof Object.getOwnPropertySymbols === \"function\")\n            for (var i = 0, p = Object.getOwnPropertySymbols(s); i < p.length; i++) {\n                if (e.indexOf(p[i]) < 0 && Object.prototype.propertyIsEnumerable.call(s, p[i])) t[p[i]] = s[p[i]];\n            }\n        return t;\n    };\nvar __importDefault =\n    (this && this.__importDefault) ||\n    function (mod) {\n        return mod && mod.__esModule ? mod : { default: mod };\n    };\nObject.defineProperty(exports, \"__esModule\", { value: true });\nvar jsx_runtime_1 = require(\"@emotion/react/jsx-runtime\");\n/* Copyright (c) 2021, VRAI Labs and/or its affiliates. All rights reserved.\n *\n * This software is licensed under the Apache License, Version 2.0 (the\n * \"License\") as published by the Apache Software Foundation.\n *\n * You may not use this file except in compliance with the License. You may\n * obtain a copy of the License at http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS, WITHOUT\n * WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied. See the\n * License for the specific language governing permissions and limitations\n * under the License.\n */\n/*\n * Imports.\n */\nvar react_1 = require(\"react\");\nvar sessionContext_1 = __importDefault(require(\"./sessionContext\"));\nvar recipe_1 = __importDefault(require(\"./recipe\"));\nvar usercontext_1 = require(\"../../usercontext\");\nvar userContextWrapper_1 = __importDefault(require(\"../../usercontext/userContextWrapper\"));\nvar utils_1 = require(\"../../utils\");\nvar superTokens_1 = __importDefault(require(\"../../superTokens\"));\nvar SessionAuth = function (_a) {\n    var _b;\n    var children = _a.children,\n        props = __rest(_a, [\"children\"]);\n    var requireAuth = (0, react_1.useRef)(props.requireAuth);\n    if (props.requireAuth !== requireAuth.current) {\n        throw new Error(\n            // eslint-disable-next-line @typescript-eslint/quotes\n            'requireAuth prop should not change. If you are seeing this, it probably means that you are using SessionAuth in multiple routes with different values for requireAuth. To solve this, try adding the \"key\" prop to all uses of SessionAuth like <SessionAuth key=\"someUniqueKeyPerRoute\" requireAuth={...}>'\n        );\n    }\n    // Reusing the parent context was removed because it caused a redirect loop in an edge case\n    // because it'd also reuse the invalid claims part until it loaded.\n    var _c = (0, react_1.useState)({ loading: true }),\n        context = _c[0],\n        setContext = _c[1];\n    var session = (0, react_1.useRef)();\n    // We store this here, to prevent the list of called hooks changing even if a history hook is added later to SuperTokens.\n    var historyHookRef = (0, react_1.useRef)(\n        (_b = superTokens_1.default.getReactRouterDomWithCustomHistory()) === null || _b === void 0\n            ? void 0\n            : _b.useHistoryCustom\n    );\n    var history;\n    try {\n        if (historyHookRef.current) {\n            history = historyHookRef.current();\n        }\n    } catch (_d) {\n        // We catch and ignore errors here, because if this is may throw if\n        // the app is using react-router-dom but added a session auth outside of the router.\n    }\n    var userContext = (0, usercontext_1.useUserContext)();\n    var redirectToLogin = (0, react_1.useCallback)(function () {\n        void superTokens_1.default.getInstanceOrThrow().redirectToAuth({ history: history, redirectBack: true });\n    }, []);\n    var buildContext = (0, react_1.useCallback)(function () {\n        return __awaiter(void 0, void 0, void 0, function () {\n            var sessionExists, invalidClaims, err_1, invalidClaimRedirectToPath, err_2;\n            var _a;\n            return __generator(this, function (_b) {\n                switch (_b.label) {\n                    case 0:\n                        if (session.current === undefined) {\n                            session.current = recipe_1.default.getInstanceOrThrow();\n                        }\n                        return [\n                            4 /*yield*/,\n                            session.current.doesSessionExist({\n                                userContext: userContext,\n                            }),\n                        ];\n                    case 1:\n                        sessionExists = _b.sent();\n                        if (sessionExists === false) {\n                            return [\n                                2 /*return*/,\n                                {\n                                    loading: false,\n                                    doesSessionExist: false,\n                                    accessTokenPayload: {},\n                                    invalidClaims: [],\n                                    userId: \"\",\n                                },\n                            ];\n                        }\n                        _b.label = 2;\n                    case 2:\n                        _b.trys.push([2, 4, , 6]);\n                        return [\n                            4 /*yield*/,\n                            session.current.validateClaims({\n                                overrideGlobalClaimValidators: props.overrideGlobalClaimValidators,\n                                userContext: userContext,\n                            }),\n                        ];\n                    case 3:\n                        invalidClaims = _b.sent();\n                        return [3 /*break*/, 6];\n                    case 4:\n                        err_1 = _b.sent();\n                        return [\n                            4 /*yield*/,\n                            session.current.doesSessionExist({\n                                userContext: userContext,\n                            }),\n                        ];\n                    case 5:\n                        // These errors should only come from getAccessTokenPayloadSecurely inside validateClaims if refreshing a claim cleared the session\n                        // Which means that the session was most likely cleared, meaning returning false is right.\n                        // This might also happen if the user provides an override or a custom claim validator that throws (or if we have a bug)\n                        // In which case the session will not be cleared so we rethrow the error\n                        if (_b.sent()) {\n                            throw err_1;\n                        }\n                        return [\n                            2 /*return*/,\n                            {\n                                loading: false,\n                                doesSessionExist: false,\n                                accessTokenPayload: {},\n                                invalidClaims: [],\n                                userId: \"\",\n                            },\n                        ];\n                    case 6:\n                        invalidClaimRedirectToPath = (0, utils_1.popInvalidClaimRedirectPathFromContext)(userContext);\n                        _b.label = 7;\n                    case 7:\n                        _b.trys.push([7, 10, , 12]);\n                        _a = {\n                            loading: false,\n                            doesSessionExist: true,\n                            invalidClaims: invalidClaims,\n                            invalidClaimRedirectToPath: invalidClaimRedirectToPath,\n                        };\n                        return [\n                            4 /*yield*/,\n                            session.current.getAccessTokenPayloadSecurely({\n                                userContext: userContext,\n                            }),\n                        ];\n                    case 8:\n                        _a.accessTokenPayload = _b.sent();\n                        return [\n                            4 /*yield*/,\n                            session.current.getUserId({\n                                userContext: userContext,\n                            }),\n                        ];\n                    case 9:\n                        return [2 /*return*/, ((_a.userId = _b.sent()), _a)];\n                    case 10:\n                        err_2 = _b.sent();\n                        return [\n                            4 /*yield*/,\n                            session.current.doesSessionExist({\n                                userContext: userContext,\n                            }),\n                        ];\n                    case 11:\n                        if (_b.sent()) {\n                            throw err_2;\n                        }\n                        // This means that loading the access token or the userId failed\n                        // This may happen if the server cleared the error since the validation was done which should be extremely rare\n                        return [\n                            2 /*return*/,\n                            {\n                                loading: false,\n                                doesSessionExist: false,\n                                accessTokenPayload: {},\n                                invalidClaims: [],\n                                userId: \"\",\n                            },\n                        ];\n                    case 12:\n                        return [2 /*return*/];\n                }\n            });\n        });\n    }, []);\n    var setInitialContextAndMaybeRedirect = (0, react_1.useCallback)(\n        function (toSetContext) {\n            return __awaiter(void 0, void 0, void 0, function () {\n                return __generator(this, function (_a) {\n                    switch (_a.label) {\n                        case 0:\n                            if (context.loading === false) {\n                                return [2 /*return*/];\n                            }\n                            if (!(props.doRedirection !== false)) return [3 /*break*/, 3];\n                            if (!(!toSetContext.doesSessionExist && props.requireAuth !== false))\n                                return [3 /*break*/, 1];\n                            redirectToLogin();\n                            return [2 /*return*/];\n                        case 1:\n                            if (!(toSetContext.invalidClaimRedirectToPath !== undefined)) return [3 /*break*/, 3];\n                            return [\n                                4 /*yield*/,\n                                superTokens_1.default\n                                    .getInstanceOrThrow()\n                                    .redirectToUrl(toSetContext.invalidClaimRedirectToPath, history),\n                            ];\n                        case 2:\n                            _a.sent();\n                            return [2 /*return*/];\n                        case 3:\n                            delete toSetContext.invalidClaimRedirectToPath;\n                            setContext(toSetContext);\n                            return [2 /*return*/];\n                    }\n                });\n            });\n        },\n        [props.doRedirection, props.requireAuth, redirectToLogin, context]\n    );\n    (0, utils_1.useOnMountAPICall)(buildContext, setInitialContextAndMaybeRedirect);\n    // subscribe to events on mount\n    (0, react_1.useEffect)(\n        function () {\n            function onHandleEvent(event) {\n                return __awaiter(this, void 0, void 0, function () {\n                    var _a, invalidClaims, redirectPath;\n                    return __generator(this, function (_b) {\n                        switch (_b.label) {\n                            case 0:\n                                _a = event.action;\n                                switch (_a) {\n                                    case \"SESSION_CREATED\":\n                                        return [3 /*break*/, 1];\n                                    case \"REFRESH_SESSION\":\n                                        return [3 /*break*/, 1];\n                                    case \"ACCESS_TOKEN_PAYLOAD_UPDATED\":\n                                        return [3 /*break*/, 1];\n                                    case \"API_INVALID_CLAIM\":\n                                        return [3 /*break*/, 1];\n                                    case \"SIGN_OUT\":\n                                        return [3 /*break*/, 5];\n                                    case \"UNAUTHORISED\":\n                                        return [3 /*break*/, 6];\n                                }\n                                return [3 /*break*/, 7];\n                            case 1:\n                                return [\n                                    4 /*yield*/,\n                                    session.current.validateClaims({\n                                        overrideGlobalClaimValidators: props.overrideGlobalClaimValidators,\n                                        userContext: userContext,\n                                    }),\n                                ];\n                            case 2:\n                                invalidClaims = _b.sent();\n                                setContext(\n                                    __assign(__assign({}, event.sessionContext), {\n                                        loading: false,\n                                        invalidClaims: invalidClaims,\n                                    })\n                                );\n                                redirectPath = (0, utils_1.popInvalidClaimRedirectPathFromContext)(userContext);\n                                if (!(props.doRedirection !== false && redirectPath)) return [3 /*break*/, 4];\n                                return [\n                                    4 /*yield*/,\n                                    superTokens_1.default.getInstanceOrThrow().redirectToUrl(redirectPath, history),\n                                ];\n                            case 3:\n                                _b.sent();\n                                _b.label = 4;\n                            case 4:\n                                return [2 /*return*/];\n                            case 5:\n                                setContext(\n                                    __assign(__assign({}, event.sessionContext), { loading: false, invalidClaims: [] })\n                                );\n                                return [2 /*return*/];\n                            case 6:\n                                setContext(\n                                    __assign(__assign({}, event.sessionContext), { loading: false, invalidClaims: [] })\n                                );\n                                if (props.onSessionExpired !== undefined) {\n                                    props.onSessionExpired();\n                                } else if (props.requireAuth !== false && props.doRedirection !== false) {\n                                    redirectToLogin();\n                                }\n                                return [2 /*return*/];\n                            case 7:\n                                return [2 /*return*/];\n                        }\n                    });\n                });\n            }\n            if (session.current === undefined) {\n                session.current = recipe_1.default.getInstanceOrThrow();\n            }\n            if (context.loading === false) {\n                // we return here cause addEventListener returns a function that removes\n                // the listener, and this function will be called by useEffect when\n                // onHandleEvent changes or if the component is unmounting.\n                return session.current.addEventListener(onHandleEvent);\n            }\n            return undefined;\n        },\n        [props, setContext, context.loading]\n    );\n    if (props.requireAuth !== false && (context.loading || !context.doesSessionExist)) {\n        return null;\n    }\n    return (0, jsx_runtime_1.jsx)(\n        sessionContext_1.default.Provider,\n        __assign({ value: context }, { children: children })\n    );\n};\nvar SessionAuthWrapper = function (props) {\n    return (0, jsx_runtime_1.jsx)(\n        userContextWrapper_1.default,\n        __assign(\n            { userContext: props.userContext },\n            { children: (0, jsx_runtime_1.jsx)(SessionAuth, __assign({}, props)) }\n        )\n    );\n};\nexports.default = SessionAuthWrapper;\n"],"mappings":"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"},"metadata":{},"sourceType":"script","externalDependencies":[]}