{"ast":null,"code":"\"use strict\";\n\n/* Copyright (c) 2021, VRAI Labs and/or its affiliates. All rights reserved.\n *\n * This software is licensed under the Apache License, Version 2.0 (the\n * \"License\") as published by the Apache Software Foundation.\n *\n * You may not use this file except in compliance with the License. You may\n * obtain a copy of the License at http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS, WITHOUT\n * WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied. See the\n * License for the specific language governing permissions and limitations\n * under the License.\n */\nvar __assign = this && this.__assign || function () {\n  __assign = Object.assign || function (t) {\n    for (var s, i = 1, n = arguments.length; i < n; i++) {\n      s = arguments[i];\n      for (var p in s) if (Object.prototype.hasOwnProperty.call(s, p)) t[p] = s[p];\n    }\n    return t;\n  };\n  return __assign.apply(this, arguments);\n};\nvar __awaiter = this && this.__awaiter || function (thisArg, _arguments, P, generator) {\n  function adopt(value) {\n    return value instanceof P ? value : new P(function (resolve) {\n      resolve(value);\n    });\n  }\n  return new (P || (P = Promise))(function (resolve, reject) {\n    function fulfilled(value) {\n      try {\n        step(generator.next(value));\n      } catch (e) {\n        reject(e);\n      }\n    }\n    function rejected(value) {\n      try {\n        step(generator[\"throw\"](value));\n      } catch (e) {\n        reject(e);\n      }\n    }\n    function step(result) {\n      result.done ? resolve(result.value) : adopt(result.value).then(fulfilled, rejected);\n    }\n    step((generator = generator.apply(thisArg, _arguments || [])).next());\n  });\n};\nvar __generator = this && this.__generator || function (thisArg, body) {\n  var _ = {\n      label: 0,\n      sent: function () {\n        if (t[0] & 1) throw t[1];\n        return t[1];\n      },\n      trys: [],\n      ops: []\n    },\n    f,\n    y,\n    t,\n    g;\n  return g = {\n    next: verb(0),\n    throw: verb(1),\n    return: verb(2)\n  }, typeof Symbol === \"function\" && (g[Symbol.iterator] = function () {\n    return this;\n  }), g;\n  function verb(n) {\n    return function (v) {\n      return step([n, v]);\n    };\n  }\n  function step(op) {\n    if (f) throw new TypeError(\"Generator is already executing.\");\n    while (_) try {\n      if (f = 1, y && (t = op[0] & 2 ? y[\"return\"] : op[0] ? y[\"throw\"] || ((t = y[\"return\"]) && t.call(y), 0) : y.next) && !(t = t.call(y, op[1])).done) return t;\n      if (y = 0, t) op = [op[0] & 2, t.value];\n      switch (op[0]) {\n        case 0:\n        case 1:\n          t = op;\n          break;\n        case 4:\n          _.label++;\n          return {\n            value: op[1],\n            done: false\n          };\n        case 5:\n          _.label++;\n          y = op[1];\n          op = [0];\n          continue;\n        case 7:\n          op = _.ops.pop();\n          _.trys.pop();\n          continue;\n        default:\n          if (!(t = _.trys, t = t.length > 0 && t[t.length - 1]) && (op[0] === 6 || op[0] === 2)) {\n            _ = 0;\n            continue;\n          }\n          if (op[0] === 3 && (!t || op[1] > t[0] && op[1] < t[3])) {\n            _.label = op[1];\n            break;\n          }\n          if (op[0] === 6 && _.label < t[1]) {\n            _.label = t[1];\n            t = op;\n            break;\n          }\n          if (t && _.label < t[2]) {\n            _.label = t[2];\n            _.ops.push(op);\n            break;\n          }\n          if (t[2]) _.ops.pop();\n          _.trys.pop();\n          continue;\n      }\n      op = body.call(thisArg, _);\n    } catch (e) {\n      op = [6, e];\n      y = 0;\n    } finally {\n      f = t = 0;\n    }\n    if (op[0] & 5) throw op[1];\n    return {\n      value: op[0] ? op[1] : void 0,\n      done: true\n    };\n  }\n};\nvar __importDefault = this && this.__importDefault || function (mod) {\n  return mod && mod.__esModule ? mod : {\n    default: mod\n  };\n};\nObject.defineProperty(exports, \"__esModule\", {\n  value: true\n});\nexports.popInvalidClaimRedirectPathFromContext = exports.saveInvalidClaimRedirectPathInContext = exports.useOnMountAPICall = exports.getNormalisedUserContext = exports.setFrontendCookie = exports.getCookieValue = exports.getDefaultCookieScope = exports.normaliseCookieScopeOrThrowError = exports.mergeObjects = exports.removeFromLocalStorage = exports.setLocalStorage = exports.getLocalStorage = exports.getOriginOfPage = exports.isIE = exports.redirectWithHistory = exports.redirectWithFullPageReload = exports.matchRecipeIdUsingQueryParams = exports.appendQueryParamsToURL = exports.getCurrentNormalisedUrlPath = exports.validateForm = exports.normaliseInputAppInfoOrThrowError = exports.isTest = exports.getRedirectToPathFromURL = exports.getURLHash = exports.getQueryParams = exports.clearErrorQueryParam = exports.clearQueryParams = exports.getRecipeIdFromSearch = void 0;\nvar react_1 = require(\"react\");\nvar constants_1 = require(\"./constants\");\nvar cookieHandler_1 = require(\"supertokens-website/utils/cookieHandler\");\nvar normalisedURLDomain_1 = __importDefault(require(\"supertokens-web-js/utils/normalisedURLDomain\"));\nvar normalisedURLPath_1 = __importDefault(require(\"supertokens-web-js/utils/normalisedURLPath\"));\nvar windowHandler_1 = require(\"supertokens-website/utils/windowHandler\");\n/*\n * getRecipeIdFromPath\n * Input:\n * Output: The \"rid\" query param if present, null otherwise.\n */\nfunction getRecipeIdFromSearch(search) {\n  var urlParams = new URLSearchParams(search);\n  return urlParams.get(constants_1.RECIPE_ID_QUERY_PARAM);\n}\nexports.getRecipeIdFromSearch = getRecipeIdFromSearch;\nfunction clearQueryParams(paramNames) {\n  var newURL = new URL(windowHandler_1.WindowHandlerReference.getReferenceOrThrow().windowHandler.location.getHref());\n  for (var _i = 0, paramNames_1 = paramNames; _i < paramNames_1.length; _i++) {\n    var param = paramNames_1[_i];\n    newURL.searchParams.delete(param);\n  }\n  windowHandler_1.WindowHandlerReference.getReferenceOrThrow().windowHandler.history.replaceState(windowHandler_1.WindowHandlerReference.getReferenceOrThrow().windowHandler.history.getState(), \"\", windowHandler_1.WindowHandlerReference.getReferenceOrThrow().windowHandler.location.getHref());\n}\nexports.clearQueryParams = clearQueryParams;\nfunction clearErrorQueryParam() {\n  clearQueryParams([\"error\", \"message\"]);\n}\nexports.clearErrorQueryParam = clearErrorQueryParam;\nfunction getQueryParams(param) {\n  var urlParams = new URLSearchParams(windowHandler_1.WindowHandlerReference.getReferenceOrThrow().windowHandler.location.getSearch());\n  return urlParams.get(param);\n}\nexports.getQueryParams = getQueryParams;\nfunction getURLHash() {\n  // By default it is returined with the \"#\" at the beginning, we cut that off here.\n  return windowHandler_1.WindowHandlerReference.getReferenceOrThrow().windowHandler.location.getHash().substr(1);\n}\nexports.getURLHash = getURLHash;\nfunction getRedirectToPathFromURL() {\n  var param = getQueryParams(\"redirectToPath\");\n  if (param === null) {\n    return undefined;\n  } else {\n    // Prevent Open redirects by normalising path.\n    try {\n      return new normalisedURLPath_1.default(param).getAsStringDangerous();\n    } catch (_a) {\n      return undefined;\n    }\n  }\n}\nexports.getRedirectToPathFromURL = getRedirectToPathFromURL;\n/*\n * isTest\n */\nfunction isTest() {\n  try {\n    return process.env.TEST_MODE === \"testing\";\n  } catch (err) {\n    // can get Uncaught ReferenceError: process is not defined error\n    return false;\n  }\n}\nexports.isTest = isTest;\nfunction normaliseInputAppInfoOrThrowError(appInfo) {\n  if (appInfo === undefined) {\n    throw new Error(\"Please provide the appInfo object when calling supertokens.init\");\n  }\n  if (appInfo.apiDomain === undefined) {\n    throw new Error(\"Please provide your apiDomain inside the appInfo object when calling supertokens.init\");\n  }\n  if (appInfo.appName === undefined) {\n    throw new Error(\"Please provide your appName inside the appInfo object when calling supertokens.init\");\n  }\n  if (appInfo.websiteDomain === undefined) {\n    throw new Error(\"Please provide your websiteDomain inside the appInfo object when calling supertokens.init\");\n  }\n  var apiGatewayPath = new normalisedURLPath_1.default(\"\");\n  if (appInfo.apiGatewayPath !== undefined) {\n    apiGatewayPath = new normalisedURLPath_1.default(appInfo.apiGatewayPath);\n  }\n  return {\n    appName: appInfo.appName,\n    apiDomain: new normalisedURLDomain_1.default(appInfo.apiDomain),\n    websiteDomain: new normalisedURLDomain_1.default(appInfo.websiteDomain),\n    apiBasePath: apiGatewayPath.appendPath(getNormalisedURLPathOrDefault(constants_1.DEFAULT_API_BASE_PATH, appInfo.apiBasePath)),\n    websiteBasePath: getNormalisedURLPathOrDefault(constants_1.DEFAULT_WEBSITE_BASE_PATH, appInfo.websiteBasePath)\n  };\n}\nexports.normaliseInputAppInfoOrThrowError = normaliseInputAppInfoOrThrowError;\nfunction getNormalisedURLPathOrDefault(defaultPath, path) {\n  if (path !== undefined) {\n    return new normalisedURLPath_1.default(path);\n  } else {\n    return new normalisedURLPath_1.default(defaultPath);\n  }\n}\n/*\n * validateForm\n */\n// We check that the number of fields in input and config form field is the same.\n// We check that each item in the config form field is also present in the input form field\nfunction validateForm(inputs, configFormFields) {\n  return __awaiter(this, void 0, void 0, function () {\n    var validationErrors, _loop_1, i;\n    return __generator(this, function (_a) {\n      switch (_a.label) {\n        case 0:\n          validationErrors = [];\n          if (configFormFields.length !== inputs.length) {\n            throw Error(\"Are you sending too many / too few formFields?\");\n          }\n          _loop_1 = function (i) {\n            var field, input, value, error;\n            return __generator(this, function (_b) {\n              switch (_b.label) {\n                case 0:\n                  field = configFormFields[i];\n                  input = inputs.find(function (i) {\n                    return i.id === field.id;\n                  });\n                  value = input.value;\n                  if (input.id === \"email\") {\n                    value = value.trim();\n                  }\n                  return [4 /*yield*/, field.validate(value)];\n                case 1:\n                  error = _b.sent();\n                  // If error, add it.\n                  if (error !== undefined) {\n                    validationErrors.push({\n                      error: error,\n                      id: field.id\n                    });\n                  }\n                  return [2 /*return*/];\n              }\n            });\n          };\n\n          i = 0;\n          _a.label = 1;\n        case 1:\n          if (!(i < configFormFields.length)) return [3 /*break*/, 4];\n          return [5 /*yield**/, _loop_1(i)];\n        case 2:\n          _a.sent();\n          _a.label = 3;\n        case 3:\n          i++;\n          return [3 /*break*/, 1];\n        case 4:\n          return [2 /*return*/, validationErrors];\n      }\n    });\n  });\n}\nexports.validateForm = validateForm;\n/*\n * getCurrentNormalisedUrlPath\n */\nfunction getCurrentNormalisedUrlPath() {\n  return new normalisedURLPath_1.default(windowHandler_1.WindowHandlerReference.getReferenceOrThrow().windowHandler.location.getPathName());\n}\nexports.getCurrentNormalisedUrlPath = getCurrentNormalisedUrlPath;\nfunction appendQueryParamsToURL(stringUrl, queryParams) {\n  if (queryParams === undefined) {\n    return stringUrl;\n  }\n  try {\n    var url_1 = new URL(stringUrl);\n    Object.entries(queryParams).forEach(function (_a) {\n      var key = _a[0],\n        value = _a[1];\n      url_1.searchParams.set(key, value);\n    });\n    return url_1.href;\n  } catch (e) {\n    var fakeDomain = stringUrl.startsWith(\"/\") ? \"http:localhost\" : \"http://localhost/\";\n    var url_2 = new URL(\"\".concat(fakeDomain).concat(stringUrl));\n    Object.entries(queryParams).forEach(function (_a) {\n      var key = _a[0],\n        value = _a[1];\n      url_2.searchParams.set(key, value);\n    });\n    return \"\".concat(url_2.pathname).concat(url_2.search);\n  }\n}\nexports.appendQueryParamsToURL = appendQueryParamsToURL;\n/*\n * Default method for matching recipe route based on query params.\n */\nfunction matchRecipeIdUsingQueryParams(recipeId) {\n  return function () {\n    var recipeIdFromSearch = getRecipeIdFromSearch(windowHandler_1.WindowHandlerReference.getReferenceOrThrow().windowHandler.location.getSearch());\n    return recipeIdFromSearch === recipeId;\n  };\n}\nexports.matchRecipeIdUsingQueryParams = matchRecipeIdUsingQueryParams;\nfunction redirectWithFullPageReload(to) {\n  if (to.trim() === \"\") {\n    to = \"/\";\n  }\n  windowHandler_1.WindowHandlerReference.getReferenceOrThrow().windowHandler.location.setHref(to);\n}\nexports.redirectWithFullPageReload = redirectWithFullPageReload;\nfunction redirectWithHistory(to, history) {\n  if (to.trim() === \"\") {\n    to = \"/\";\n  }\n  if (history.push !== undefined) {\n    // we are using react-router-dom that is before v6\n    history.push(to);\n  } else {\n    // in react-router-dom v6, it is just navigate(to), and we are renaming\n    // naviagte to history, so it becomes history(to).\n    history(to);\n  }\n}\nexports.redirectWithHistory = redirectWithHistory;\nfunction isIE() {\n  return windowHandler_1.WindowHandlerReference.getReferenceOrThrow().windowHandler.getDocument().documentMode !== undefined;\n}\nexports.isIE = isIE;\nfunction getOriginOfPage() {\n  return new normalisedURLDomain_1.default(windowHandler_1.WindowHandlerReference.getReferenceOrThrow().windowHandler.location.getOrigin());\n}\nexports.getOriginOfPage = getOriginOfPage;\nfunction getLocalStorage(key) {\n  return __awaiter(this, void 0, void 0, function () {\n    var res;\n    return __generator(this, function (_a) {\n      res = windowHandler_1.WindowHandlerReference.getReferenceOrThrow().windowHandler.localStorage.getItem(key);\n      if (res === null || res === undefined) {\n        return [2 /*return*/, null];\n      }\n      return [2 /*return*/, res];\n    });\n  });\n}\nexports.getLocalStorage = getLocalStorage;\nfunction setLocalStorage(key, value) {\n  return __awaiter(this, void 0, void 0, function () {\n    return __generator(this, function (_a) {\n      switch (_a.label) {\n        case 0:\n          return [4 /*yield*/, windowHandler_1.WindowHandlerReference.getReferenceOrThrow().windowHandler.localStorage.setItem(key, value)];\n        case 1:\n          _a.sent();\n          return [2 /*return*/];\n      }\n    });\n  });\n}\n\nexports.setLocalStorage = setLocalStorage;\nfunction removeFromLocalStorage(key) {\n  return __awaiter(this, void 0, void 0, function () {\n    return __generator(this, function (_a) {\n      switch (_a.label) {\n        case 0:\n          return [4 /*yield*/, windowHandler_1.WindowHandlerReference.getReferenceOrThrow().windowHandler.localStorage.removeItem(key)];\n        case 1:\n          _a.sent();\n          return [2 /*return*/];\n      }\n    });\n  });\n}\n\nexports.removeFromLocalStorage = removeFromLocalStorage;\nfunction mergeObjects(obj1, obj2) {\n  var res = __assign({}, obj1);\n  for (var key in obj2) {\n    if (typeof res[key] === \"object\" && typeof obj2[key] === \"object\") {\n      res[key] = mergeObjects(res[key], obj2[key]);\n    } else {\n      res[key] = obj2[key];\n    }\n  }\n  return res;\n}\nexports.mergeObjects = mergeObjects;\nfunction normaliseCookieScopeOrThrowError(cookieScope) {\n  function helper(sessionScope) {\n    sessionScope = sessionScope.trim().toLowerCase();\n    // first we convert it to a URL so that we can use the URL class\n    if (sessionScope.startsWith(\".\")) {\n      sessionScope = sessionScope.substr(1);\n    }\n    if (!sessionScope.startsWith(\"http://\") && !sessionScope.startsWith(\"https://\")) {\n      sessionScope = \"http://\" + sessionScope;\n    }\n    try {\n      var urlObj = new URL(sessionScope);\n      sessionScope = urlObj.hostname;\n      // remove leading dot\n      if (sessionScope.startsWith(\".\")) {\n        sessionScope = sessionScope.substr(1);\n      }\n      return sessionScope;\n    } catch (err) {\n      throw new Error(\"Please provide a valid cookie scope\");\n    }\n  }\n  function isAnIpAddress(ipaddress) {\n    return /^(25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)\\.(25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)\\.(25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)\\.(25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)$/.test(ipaddress);\n  }\n  var noDotNormalised = helper(cookieScope);\n  if (noDotNormalised === \"localhost\" || isAnIpAddress(noDotNormalised)) {\n    return noDotNormalised;\n  }\n  if (cookieScope.startsWith(\".\")) {\n    return \".\" + noDotNormalised;\n  }\n  return noDotNormalised;\n}\nexports.normaliseCookieScopeOrThrowError = normaliseCookieScopeOrThrowError;\nfunction getDefaultCookieScope() {\n  try {\n    return normaliseCookieScopeOrThrowError(windowHandler_1.WindowHandlerReference.getReferenceOrThrow().windowHandler.location.getHostName());\n  } catch (_a) {\n    return undefined;\n  }\n}\nexports.getDefaultCookieScope = getDefaultCookieScope;\nfunction getCookieValue(name) {\n  return __awaiter(this, void 0, void 0, function () {\n    var value, _a, parts, last, temp;\n    return __generator(this, function (_b) {\n      switch (_b.label) {\n        case 0:\n          _a = \"; \";\n          return [4 /*yield*/, cookieHandler_1.CookieHandlerReference.getReferenceOrThrow().cookieHandler.getCookie()];\n        case 1:\n          value = _a + _b.sent();\n          parts = value.split(\"; \" + name + \"=\");\n          if (parts.length >= 2) {\n            last = parts.pop();\n            if (last !== undefined) {\n              temp = last.split(\";\").shift();\n              if (temp === undefined) {\n                return [2 /*return*/, null];\n              }\n              return [2 /*return*/, temp];\n            }\n          }\n          return [2 /*return*/, null];\n      }\n    });\n  });\n}\nexports.getCookieValue = getCookieValue;\n// undefined value will remove the cookie\nfunction setFrontendCookie(name, value, scope) {\n  return __awaiter(this, void 0, void 0, function () {\n    var expires, cookieVal;\n    return __generator(this, function (_a) {\n      switch (_a.label) {\n        case 0:\n          expires = \"Thu, 01 Jan 1970 00:00:01 GMT\";\n          cookieVal = \"\";\n          if (value !== undefined) {\n            cookieVal = value;\n            expires = undefined; // set cookie without expiry\n          }\n\n          if (!(scope === \"localhost\" || scope === windowHandler_1.WindowHandlerReference.getReferenceOrThrow().windowHandler.location.getHostName() || scope === undefined)) return [3 /*break*/, 5];\n          if (!(expires !== undefined)) return [3 /*break*/, 2];\n          return [4 /*yield*/, cookieHandler_1.CookieHandlerReference.getReferenceOrThrow().cookieHandler.setCookie(\"\".concat(name, \"=\").concat(cookieVal, \";expires=\").concat(expires, \";path=/;samesite=lax\"))];\n        case 1:\n          _a.sent();\n          return [3 /*break*/, 4];\n        case 2:\n          return [4 /*yield*/, cookieHandler_1.CookieHandlerReference.getReferenceOrThrow().cookieHandler.setCookie(\"\".concat(name, \"=\").concat(cookieVal, \";expires=Fri, 31 Dec 9999 23:59:59 GMT;path=/;samesite=lax\"))];\n        case 3:\n          _a.sent();\n          _a.label = 4;\n        case 4:\n          return [3 /*break*/, 9];\n        case 5:\n          if (!(expires !== undefined)) return [3 /*break*/, 7];\n          return [4 /*yield*/, cookieHandler_1.CookieHandlerReference.getReferenceOrThrow().cookieHandler.setCookie(\"\".concat(name, \"=\").concat(cookieVal, \";expires=\").concat(expires, \";domain=\").concat(scope, \";path=/;samesite=lax\"))];\n        case 6:\n          _a.sent();\n          return [3 /*break*/, 9];\n        case 7:\n          return [4 /*yield*/, cookieHandler_1.CookieHandlerReference.getReferenceOrThrow().cookieHandler.setCookie(\"\".concat(name, \"=\").concat(cookieVal, \";domain=\").concat(scope, \";expires=Fri, 31 Dec 9999 23:59:59 GMT;path=/;samesite=lax\"))];\n        case 8:\n          _a.sent();\n          _a.label = 9;\n        case 9:\n          return [2 /*return*/];\n      }\n    });\n  });\n}\n\nexports.setFrontendCookie = setFrontendCookie;\nfunction getNormalisedUserContext(userContext) {\n  return userContext === undefined ? {} : userContext;\n}\nexports.getNormalisedUserContext = getNormalisedUserContext;\n/**\n * This function handles calling APIs that should only be called once during mount (mostly on mount of a route/feature component).\n * It's split into multiple callbacks (fetch + handleResponse/handleError) because we expect fetch to take longer and\n * and the component may be unmounted during the first fetch, in which case we want to avoid updating state/redirecting.\n * This is especially relevant for development in strict mode with React 18 (and in the future for concurrent rendering).\n *\n * @param fetch This is a callback that is only called once on mount. Mostly it's for consuming tokens/doing one time only API calls\n * @param handleResponse This is called with the result of the first (fetch) call if it succeeds.\n * @param handleError This is called with the error of the first (fetch) call if it rejects.\n * @param startLoading Will start the whole process if this is set to true (or omitted). Mostly used to wait for session loading.\n */\nvar useOnMountAPICall = function (fetch, handleResponse, handleError, startLoading) {\n  if (startLoading === void 0) {\n    startLoading = true;\n  }\n  var consumeReq = (0, react_1.useRef)();\n  var _a = (0, react_1.useState)(undefined),\n    error = _a[0],\n    setError = _a[1];\n  (0, react_1.useEffect)(function () {\n    var effect = function (signal) {\n      return __awaiter(void 0, void 0, void 0, function () {\n        var resp, err_1;\n        return __generator(this, function (_a) {\n          switch (_a.label) {\n            case 0:\n              _a.trys.push([0, 2,, 3]);\n              if (consumeReq.current === undefined) {\n                consumeReq.current = fetch();\n              }\n              return [4 /*yield*/, consumeReq.current];\n            case 1:\n              resp = _a.sent();\n              if (!signal.aborted) {\n                void handleResponse(resp);\n              }\n              return [3 /*break*/, 3];\n            case 2:\n              err_1 = _a.sent();\n              if (!signal.aborted) {\n                if (handleError !== undefined) {\n                  handleError(err_1, resp);\n                } else {\n                  setError(err_1);\n                }\n              }\n              return [3 /*break*/, 3];\n            case 3:\n              return [2 /*return*/];\n          }\n        });\n      });\n    };\n\n    if (startLoading) {\n      var ctrl_1 = new AbortController();\n      void effect(ctrl_1.signal);\n      return function () {\n        ctrl_1.abort();\n      };\n    }\n    return;\n  }, [setError, consumeReq, fetch, handleResponse, handleError, startLoading]);\n  if (error) {\n    throw error;\n  }\n};\nexports.useOnMountAPICall = useOnMountAPICall;\nfunction saveInvalidClaimRedirectPathInContext(userContext, invalidClaimRedirectPath) {\n  if (userContext[\"_default\"] === undefined) {\n    userContext[\"_default\"] = {};\n  }\n  if (userContext[\"_default\"].redirectPath === undefined) {\n    userContext[\"_default\"] = __assign(__assign({}, userContext[\"_default\"]), {\n      invalidClaimRedirectPath: invalidClaimRedirectPath\n    });\n  }\n}\nexports.saveInvalidClaimRedirectPathInContext = saveInvalidClaimRedirectPathInContext;\nfunction popInvalidClaimRedirectPathFromContext(userContext) {\n  var _a;\n  var res = (_a = userContext[\"_default\"]) === null || _a === void 0 ? void 0 : _a.invalidClaimRedirectPath;\n  if (res !== undefined) {\n    delete userContext[\"_default\"].invalidClaimRedirectPath;\n  }\n  return res;\n}\nexports.popInvalidClaimRedirectPathFromContext = popInvalidClaimRedirectPathFromContext;","map":{"version":3,"names":["__assign","Object","assign","t","s","i","n","arguments","length","p","prototype","hasOwnProperty","call","apply","__awaiter","thisArg","_arguments","P","generator","adopt","value","resolve","Promise","reject","fulfilled","step","next","e","rejected","result","done","then","__generator","body","_","label","sent","trys","ops","f","y","g","verb","throw","return","Symbol","iterator","v","op","TypeError","pop","push","__importDefault","mod","__esModule","default","defineProperty","exports","popInvalidClaimRedirectPathFromContext","saveInvalidClaimRedirectPathInContext","useOnMountAPICall","getNormalisedUserContext","setFrontendCookie","getCookieValue","getDefaultCookieScope","normaliseCookieScopeOrThrowError","mergeObjects","removeFromLocalStorage","setLocalStorage","getLocalStorage","getOriginOfPage","isIE","redirectWithHistory","redirectWithFullPageReload","matchRecipeIdUsingQueryParams","appendQueryParamsToURL","getCurrentNormalisedUrlPath","validateForm","normaliseInputAppInfoOrThrowError","isTest","getRedirectToPathFromURL","getURLHash","getQueryParams","clearErrorQueryParam","clearQueryParams","getRecipeIdFromSearch","react_1","require","constants_1","cookieHandler_1","normalisedURLDomain_1","normalisedURLPath_1","windowHandler_1","search","urlParams","URLSearchParams","get","RECIPE_ID_QUERY_PARAM","paramNames","newURL","URL","WindowHandlerReference","getReferenceOrThrow","windowHandler","location","getHref","_i","paramNames_1","param","searchParams","delete","history","replaceState","getState","getSearch","getHash","substr","undefined","getAsStringDangerous","_a","process","env","TEST_MODE","err","appInfo","Error","apiDomain","appName","websiteDomain","apiGatewayPath","apiBasePath","appendPath","getNormalisedURLPathOrDefault","DEFAULT_API_BASE_PATH","websiteBasePath","DEFAULT_WEBSITE_BASE_PATH","defaultPath","path","inputs","configFormFields","validationErrors","_loop_1","field","input","error","_b","find","id","trim","validate","getPathName","stringUrl","queryParams","url_1","entries","forEach","key","set","href","fakeDomain","startsWith","url_2","concat","pathname","recipeId","recipeIdFromSearch","to","setHref","getDocument","documentMode","getOrigin","res","localStorage","getItem","setItem","removeItem","obj1","obj2","cookieScope","helper","sessionScope","toLowerCase","urlObj","hostname","isAnIpAddress","ipaddress","test","noDotNormalised","getHostName","name","parts","last","temp","CookieHandlerReference","cookieHandler","getCookie","split","shift","scope","expires","cookieVal","setCookie","userContext","fetch","handleResponse","handleError","startLoading","consumeReq","useRef","useState","setError","useEffect","effect","signal","resp","err_1","current","aborted","ctrl_1","AbortController","abort","invalidClaimRedirectPath","redirectPath"],"sources":["C:/Users/jsierra/puntodelaguaapp/frontend/node_modules/supertokens-auth-react/lib/build/utils.js"],"sourcesContent":["\"use strict\";\n/* Copyright (c) 2021, VRAI Labs and/or its affiliates. All rights reserved.\n *\n * This software is licensed under the Apache License, Version 2.0 (the\n * \"License\") as published by the Apache Software Foundation.\n *\n * You may not use this file except in compliance with the License. You may\n * obtain a copy of the License at http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS, WITHOUT\n * WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied. See the\n * License for the specific language governing permissions and limitations\n * under the License.\n */\nvar __assign =\n    (this && this.__assign) ||\n    function () {\n        __assign =\n            Object.assign ||\n            function (t) {\n                for (var s, i = 1, n = arguments.length; i < n; i++) {\n                    s = arguments[i];\n                    for (var p in s) if (Object.prototype.hasOwnProperty.call(s, p)) t[p] = s[p];\n                }\n                return t;\n            };\n        return __assign.apply(this, arguments);\n    };\nvar __awaiter =\n    (this && this.__awaiter) ||\n    function (thisArg, _arguments, P, generator) {\n        function adopt(value) {\n            return value instanceof P\n                ? value\n                : new P(function (resolve) {\n                      resolve(value);\n                  });\n        }\n        return new (P || (P = Promise))(function (resolve, reject) {\n            function fulfilled(value) {\n                try {\n                    step(generator.next(value));\n                } catch (e) {\n                    reject(e);\n                }\n            }\n            function rejected(value) {\n                try {\n                    step(generator[\"throw\"](value));\n                } catch (e) {\n                    reject(e);\n                }\n            }\n            function step(result) {\n                result.done ? resolve(result.value) : adopt(result.value).then(fulfilled, rejected);\n            }\n            step((generator = generator.apply(thisArg, _arguments || [])).next());\n        });\n    };\nvar __generator =\n    (this && this.__generator) ||\n    function (thisArg, body) {\n        var _ = {\n                label: 0,\n                sent: function () {\n                    if (t[0] & 1) throw t[1];\n                    return t[1];\n                },\n                trys: [],\n                ops: [],\n            },\n            f,\n            y,\n            t,\n            g;\n        return (\n            (g = { next: verb(0), throw: verb(1), return: verb(2) }),\n            typeof Symbol === \"function\" &&\n                (g[Symbol.iterator] = function () {\n                    return this;\n                }),\n            g\n        );\n        function verb(n) {\n            return function (v) {\n                return step([n, v]);\n            };\n        }\n        function step(op) {\n            if (f) throw new TypeError(\"Generator is already executing.\");\n            while (_)\n                try {\n                    if (\n                        ((f = 1),\n                        y &&\n                            (t =\n                                op[0] & 2\n                                    ? y[\"return\"]\n                                    : op[0]\n                                    ? y[\"throw\"] || ((t = y[\"return\"]) && t.call(y), 0)\n                                    : y.next) &&\n                            !(t = t.call(y, op[1])).done)\n                    )\n                        return t;\n                    if (((y = 0), t)) op = [op[0] & 2, t.value];\n                    switch (op[0]) {\n                        case 0:\n                        case 1:\n                            t = op;\n                            break;\n                        case 4:\n                            _.label++;\n                            return { value: op[1], done: false };\n                        case 5:\n                            _.label++;\n                            y = op[1];\n                            op = [0];\n                            continue;\n                        case 7:\n                            op = _.ops.pop();\n                            _.trys.pop();\n                            continue;\n                        default:\n                            if (\n                                !((t = _.trys), (t = t.length > 0 && t[t.length - 1])) &&\n                                (op[0] === 6 || op[0] === 2)\n                            ) {\n                                _ = 0;\n                                continue;\n                            }\n                            if (op[0] === 3 && (!t || (op[1] > t[0] && op[1] < t[3]))) {\n                                _.label = op[1];\n                                break;\n                            }\n                            if (op[0] === 6 && _.label < t[1]) {\n                                _.label = t[1];\n                                t = op;\n                                break;\n                            }\n                            if (t && _.label < t[2]) {\n                                _.label = t[2];\n                                _.ops.push(op);\n                                break;\n                            }\n                            if (t[2]) _.ops.pop();\n                            _.trys.pop();\n                            continue;\n                    }\n                    op = body.call(thisArg, _);\n                } catch (e) {\n                    op = [6, e];\n                    y = 0;\n                } finally {\n                    f = t = 0;\n                }\n            if (op[0] & 5) throw op[1];\n            return { value: op[0] ? op[1] : void 0, done: true };\n        }\n    };\nvar __importDefault =\n    (this && this.__importDefault) ||\n    function (mod) {\n        return mod && mod.__esModule ? mod : { default: mod };\n    };\nObject.defineProperty(exports, \"__esModule\", { value: true });\nexports.popInvalidClaimRedirectPathFromContext =\n    exports.saveInvalidClaimRedirectPathInContext =\n    exports.useOnMountAPICall =\n    exports.getNormalisedUserContext =\n    exports.setFrontendCookie =\n    exports.getCookieValue =\n    exports.getDefaultCookieScope =\n    exports.normaliseCookieScopeOrThrowError =\n    exports.mergeObjects =\n    exports.removeFromLocalStorage =\n    exports.setLocalStorage =\n    exports.getLocalStorage =\n    exports.getOriginOfPage =\n    exports.isIE =\n    exports.redirectWithHistory =\n    exports.redirectWithFullPageReload =\n    exports.matchRecipeIdUsingQueryParams =\n    exports.appendQueryParamsToURL =\n    exports.getCurrentNormalisedUrlPath =\n    exports.validateForm =\n    exports.normaliseInputAppInfoOrThrowError =\n    exports.isTest =\n    exports.getRedirectToPathFromURL =\n    exports.getURLHash =\n    exports.getQueryParams =\n    exports.clearErrorQueryParam =\n    exports.clearQueryParams =\n    exports.getRecipeIdFromSearch =\n        void 0;\nvar react_1 = require(\"react\");\nvar constants_1 = require(\"./constants\");\nvar cookieHandler_1 = require(\"supertokens-website/utils/cookieHandler\");\nvar normalisedURLDomain_1 = __importDefault(require(\"supertokens-web-js/utils/normalisedURLDomain\"));\nvar normalisedURLPath_1 = __importDefault(require(\"supertokens-web-js/utils/normalisedURLPath\"));\nvar windowHandler_1 = require(\"supertokens-website/utils/windowHandler\");\n/*\n * getRecipeIdFromPath\n * Input:\n * Output: The \"rid\" query param if present, null otherwise.\n */\nfunction getRecipeIdFromSearch(search) {\n    var urlParams = new URLSearchParams(search);\n    return urlParams.get(constants_1.RECIPE_ID_QUERY_PARAM);\n}\nexports.getRecipeIdFromSearch = getRecipeIdFromSearch;\nfunction clearQueryParams(paramNames) {\n    var newURL = new URL(windowHandler_1.WindowHandlerReference.getReferenceOrThrow().windowHandler.location.getHref());\n    for (var _i = 0, paramNames_1 = paramNames; _i < paramNames_1.length; _i++) {\n        var param = paramNames_1[_i];\n        newURL.searchParams.delete(param);\n    }\n    windowHandler_1.WindowHandlerReference.getReferenceOrThrow().windowHandler.history.replaceState(\n        windowHandler_1.WindowHandlerReference.getReferenceOrThrow().windowHandler.history.getState(),\n        \"\",\n        windowHandler_1.WindowHandlerReference.getReferenceOrThrow().windowHandler.location.getHref()\n    );\n}\nexports.clearQueryParams = clearQueryParams;\nfunction clearErrorQueryParam() {\n    clearQueryParams([\"error\", \"message\"]);\n}\nexports.clearErrorQueryParam = clearErrorQueryParam;\nfunction getQueryParams(param) {\n    var urlParams = new URLSearchParams(\n        windowHandler_1.WindowHandlerReference.getReferenceOrThrow().windowHandler.location.getSearch()\n    );\n    return urlParams.get(param);\n}\nexports.getQueryParams = getQueryParams;\nfunction getURLHash() {\n    // By default it is returined with the \"#\" at the beginning, we cut that off here.\n    return windowHandler_1.WindowHandlerReference.getReferenceOrThrow().windowHandler.location.getHash().substr(1);\n}\nexports.getURLHash = getURLHash;\nfunction getRedirectToPathFromURL() {\n    var param = getQueryParams(\"redirectToPath\");\n    if (param === null) {\n        return undefined;\n    } else {\n        // Prevent Open redirects by normalising path.\n        try {\n            return new normalisedURLPath_1.default(param).getAsStringDangerous();\n        } catch (_a) {\n            return undefined;\n        }\n    }\n}\nexports.getRedirectToPathFromURL = getRedirectToPathFromURL;\n/*\n * isTest\n */\nfunction isTest() {\n    try {\n        return process.env.TEST_MODE === \"testing\";\n    } catch (err) {\n        // can get Uncaught ReferenceError: process is not defined error\n        return false;\n    }\n}\nexports.isTest = isTest;\nfunction normaliseInputAppInfoOrThrowError(appInfo) {\n    if (appInfo === undefined) {\n        throw new Error(\"Please provide the appInfo object when calling supertokens.init\");\n    }\n    if (appInfo.apiDomain === undefined) {\n        throw new Error(\"Please provide your apiDomain inside the appInfo object when calling supertokens.init\");\n    }\n    if (appInfo.appName === undefined) {\n        throw new Error(\"Please provide your appName inside the appInfo object when calling supertokens.init\");\n    }\n    if (appInfo.websiteDomain === undefined) {\n        throw new Error(\"Please provide your websiteDomain inside the appInfo object when calling supertokens.init\");\n    }\n    var apiGatewayPath = new normalisedURLPath_1.default(\"\");\n    if (appInfo.apiGatewayPath !== undefined) {\n        apiGatewayPath = new normalisedURLPath_1.default(appInfo.apiGatewayPath);\n    }\n    return {\n        appName: appInfo.appName,\n        apiDomain: new normalisedURLDomain_1.default(appInfo.apiDomain),\n        websiteDomain: new normalisedURLDomain_1.default(appInfo.websiteDomain),\n        apiBasePath: apiGatewayPath.appendPath(\n            getNormalisedURLPathOrDefault(constants_1.DEFAULT_API_BASE_PATH, appInfo.apiBasePath)\n        ),\n        websiteBasePath: getNormalisedURLPathOrDefault(constants_1.DEFAULT_WEBSITE_BASE_PATH, appInfo.websiteBasePath),\n    };\n}\nexports.normaliseInputAppInfoOrThrowError = normaliseInputAppInfoOrThrowError;\nfunction getNormalisedURLPathOrDefault(defaultPath, path) {\n    if (path !== undefined) {\n        return new normalisedURLPath_1.default(path);\n    } else {\n        return new normalisedURLPath_1.default(defaultPath);\n    }\n}\n/*\n * validateForm\n */\n// We check that the number of fields in input and config form field is the same.\n// We check that each item in the config form field is also present in the input form field\nfunction validateForm(inputs, configFormFields) {\n    return __awaiter(this, void 0, void 0, function () {\n        var validationErrors, _loop_1, i;\n        return __generator(this, function (_a) {\n            switch (_a.label) {\n                case 0:\n                    validationErrors = [];\n                    if (configFormFields.length !== inputs.length) {\n                        throw Error(\"Are you sending too many / too few formFields?\");\n                    }\n                    _loop_1 = function (i) {\n                        var field, input, value, error;\n                        return __generator(this, function (_b) {\n                            switch (_b.label) {\n                                case 0:\n                                    field = configFormFields[i];\n                                    input = inputs.find(function (i) {\n                                        return i.id === field.id;\n                                    });\n                                    value = input.value;\n                                    if (input.id === \"email\") {\n                                        value = value.trim();\n                                    }\n                                    return [4 /*yield*/, field.validate(value)];\n                                case 1:\n                                    error = _b.sent();\n                                    // If error, add it.\n                                    if (error !== undefined) {\n                                        validationErrors.push({\n                                            error: error,\n                                            id: field.id,\n                                        });\n                                    }\n                                    return [2 /*return*/];\n                            }\n                        });\n                    };\n                    i = 0;\n                    _a.label = 1;\n                case 1:\n                    if (!(i < configFormFields.length)) return [3 /*break*/, 4];\n                    return [5 /*yield**/, _loop_1(i)];\n                case 2:\n                    _a.sent();\n                    _a.label = 3;\n                case 3:\n                    i++;\n                    return [3 /*break*/, 1];\n                case 4:\n                    return [2 /*return*/, validationErrors];\n            }\n        });\n    });\n}\nexports.validateForm = validateForm;\n/*\n * getCurrentNormalisedUrlPath\n */\nfunction getCurrentNormalisedUrlPath() {\n    return new normalisedURLPath_1.default(\n        windowHandler_1.WindowHandlerReference.getReferenceOrThrow().windowHandler.location.getPathName()\n    );\n}\nexports.getCurrentNormalisedUrlPath = getCurrentNormalisedUrlPath;\nfunction appendQueryParamsToURL(stringUrl, queryParams) {\n    if (queryParams === undefined) {\n        return stringUrl;\n    }\n    try {\n        var url_1 = new URL(stringUrl);\n        Object.entries(queryParams).forEach(function (_a) {\n            var key = _a[0],\n                value = _a[1];\n            url_1.searchParams.set(key, value);\n        });\n        return url_1.href;\n    } catch (e) {\n        var fakeDomain = stringUrl.startsWith(\"/\") ? \"http:localhost\" : \"http://localhost/\";\n        var url_2 = new URL(\"\".concat(fakeDomain).concat(stringUrl));\n        Object.entries(queryParams).forEach(function (_a) {\n            var key = _a[0],\n                value = _a[1];\n            url_2.searchParams.set(key, value);\n        });\n        return \"\".concat(url_2.pathname).concat(url_2.search);\n    }\n}\nexports.appendQueryParamsToURL = appendQueryParamsToURL;\n/*\n * Default method for matching recipe route based on query params.\n */\nfunction matchRecipeIdUsingQueryParams(recipeId) {\n    return function () {\n        var recipeIdFromSearch = getRecipeIdFromSearch(\n            windowHandler_1.WindowHandlerReference.getReferenceOrThrow().windowHandler.location.getSearch()\n        );\n        return recipeIdFromSearch === recipeId;\n    };\n}\nexports.matchRecipeIdUsingQueryParams = matchRecipeIdUsingQueryParams;\nfunction redirectWithFullPageReload(to) {\n    if (to.trim() === \"\") {\n        to = \"/\";\n    }\n    windowHandler_1.WindowHandlerReference.getReferenceOrThrow().windowHandler.location.setHref(to);\n}\nexports.redirectWithFullPageReload = redirectWithFullPageReload;\nfunction redirectWithHistory(to, history) {\n    if (to.trim() === \"\") {\n        to = \"/\";\n    }\n    if (history.push !== undefined) {\n        // we are using react-router-dom that is before v6\n        history.push(to);\n    } else {\n        // in react-router-dom v6, it is just navigate(to), and we are renaming\n        // naviagte to history, so it becomes history(to).\n        history(to);\n    }\n}\nexports.redirectWithHistory = redirectWithHistory;\nfunction isIE() {\n    return (\n        windowHandler_1.WindowHandlerReference.getReferenceOrThrow().windowHandler.getDocument().documentMode !==\n        undefined\n    );\n}\nexports.isIE = isIE;\nfunction getOriginOfPage() {\n    return new normalisedURLDomain_1.default(\n        windowHandler_1.WindowHandlerReference.getReferenceOrThrow().windowHandler.location.getOrigin()\n    );\n}\nexports.getOriginOfPage = getOriginOfPage;\nfunction getLocalStorage(key) {\n    return __awaiter(this, void 0, void 0, function () {\n        var res;\n        return __generator(this, function (_a) {\n            res = windowHandler_1.WindowHandlerReference.getReferenceOrThrow().windowHandler.localStorage.getItem(key);\n            if (res === null || res === undefined) {\n                return [2 /*return*/, null];\n            }\n            return [2 /*return*/, res];\n        });\n    });\n}\nexports.getLocalStorage = getLocalStorage;\nfunction setLocalStorage(key, value) {\n    return __awaiter(this, void 0, void 0, function () {\n        return __generator(this, function (_a) {\n            switch (_a.label) {\n                case 0:\n                    return [\n                        4 /*yield*/,\n                        windowHandler_1.WindowHandlerReference.getReferenceOrThrow().windowHandler.localStorage.setItem(\n                            key,\n                            value\n                        ),\n                    ];\n                case 1:\n                    _a.sent();\n                    return [2 /*return*/];\n            }\n        });\n    });\n}\nexports.setLocalStorage = setLocalStorage;\nfunction removeFromLocalStorage(key) {\n    return __awaiter(this, void 0, void 0, function () {\n        return __generator(this, function (_a) {\n            switch (_a.label) {\n                case 0:\n                    return [\n                        4 /*yield*/,\n                        windowHandler_1.WindowHandlerReference.getReferenceOrThrow().windowHandler.localStorage.removeItem(\n                            key\n                        ),\n                    ];\n                case 1:\n                    _a.sent();\n                    return [2 /*return*/];\n            }\n        });\n    });\n}\nexports.removeFromLocalStorage = removeFromLocalStorage;\nfunction mergeObjects(obj1, obj2) {\n    var res = __assign({}, obj1);\n    for (var key in obj2) {\n        if (typeof res[key] === \"object\" && typeof obj2[key] === \"object\") {\n            res[key] = mergeObjects(res[key], obj2[key]);\n        } else {\n            res[key] = obj2[key];\n        }\n    }\n    return res;\n}\nexports.mergeObjects = mergeObjects;\nfunction normaliseCookieScopeOrThrowError(cookieScope) {\n    function helper(sessionScope) {\n        sessionScope = sessionScope.trim().toLowerCase();\n        // first we convert it to a URL so that we can use the URL class\n        if (sessionScope.startsWith(\".\")) {\n            sessionScope = sessionScope.substr(1);\n        }\n        if (!sessionScope.startsWith(\"http://\") && !sessionScope.startsWith(\"https://\")) {\n            sessionScope = \"http://\" + sessionScope;\n        }\n        try {\n            var urlObj = new URL(sessionScope);\n            sessionScope = urlObj.hostname;\n            // remove leading dot\n            if (sessionScope.startsWith(\".\")) {\n                sessionScope = sessionScope.substr(1);\n            }\n            return sessionScope;\n        } catch (err) {\n            throw new Error(\"Please provide a valid cookie scope\");\n        }\n    }\n    function isAnIpAddress(ipaddress) {\n        return /^(25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)\\.(25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)\\.(25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)\\.(25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)$/.test(\n            ipaddress\n        );\n    }\n    var noDotNormalised = helper(cookieScope);\n    if (noDotNormalised === \"localhost\" || isAnIpAddress(noDotNormalised)) {\n        return noDotNormalised;\n    }\n    if (cookieScope.startsWith(\".\")) {\n        return \".\" + noDotNormalised;\n    }\n    return noDotNormalised;\n}\nexports.normaliseCookieScopeOrThrowError = normaliseCookieScopeOrThrowError;\nfunction getDefaultCookieScope() {\n    try {\n        return normaliseCookieScopeOrThrowError(\n            windowHandler_1.WindowHandlerReference.getReferenceOrThrow().windowHandler.location.getHostName()\n        );\n    } catch (_a) {\n        return undefined;\n    }\n}\nexports.getDefaultCookieScope = getDefaultCookieScope;\nfunction getCookieValue(name) {\n    return __awaiter(this, void 0, void 0, function () {\n        var value, _a, parts, last, temp;\n        return __generator(this, function (_b) {\n            switch (_b.label) {\n                case 0:\n                    _a = \"; \";\n                    return [\n                        4 /*yield*/,\n                        cookieHandler_1.CookieHandlerReference.getReferenceOrThrow().cookieHandler.getCookie(),\n                    ];\n                case 1:\n                    value = _a + _b.sent();\n                    parts = value.split(\"; \" + name + \"=\");\n                    if (parts.length >= 2) {\n                        last = parts.pop();\n                        if (last !== undefined) {\n                            temp = last.split(\";\").shift();\n                            if (temp === undefined) {\n                                return [2 /*return*/, null];\n                            }\n                            return [2 /*return*/, temp];\n                        }\n                    }\n                    return [2 /*return*/, null];\n            }\n        });\n    });\n}\nexports.getCookieValue = getCookieValue;\n// undefined value will remove the cookie\nfunction setFrontendCookie(name, value, scope) {\n    return __awaiter(this, void 0, void 0, function () {\n        var expires, cookieVal;\n        return __generator(this, function (_a) {\n            switch (_a.label) {\n                case 0:\n                    expires = \"Thu, 01 Jan 1970 00:00:01 GMT\";\n                    cookieVal = \"\";\n                    if (value !== undefined) {\n                        cookieVal = value;\n                        expires = undefined; // set cookie without expiry\n                    }\n                    if (\n                        !(\n                            scope === \"localhost\" ||\n                            scope ===\n                                windowHandler_1.WindowHandlerReference.getReferenceOrThrow().windowHandler.location.getHostName() ||\n                            scope === undefined\n                        )\n                    )\n                        return [3 /*break*/, 5];\n                    if (!(expires !== undefined)) return [3 /*break*/, 2];\n                    return [\n                        4 /*yield*/,\n                        cookieHandler_1.CookieHandlerReference.getReferenceOrThrow().cookieHandler.setCookie(\n                            \"\".concat(name, \"=\").concat(cookieVal, \";expires=\").concat(expires, \";path=/;samesite=lax\")\n                        ),\n                    ];\n                case 1:\n                    _a.sent();\n                    return [3 /*break*/, 4];\n                case 2:\n                    return [\n                        4 /*yield*/,\n                        cookieHandler_1.CookieHandlerReference.getReferenceOrThrow().cookieHandler.setCookie(\n                            \"\"\n                                .concat(name, \"=\")\n                                .concat(cookieVal, \";expires=Fri, 31 Dec 9999 23:59:59 GMT;path=/;samesite=lax\")\n                        ),\n                    ];\n                case 3:\n                    _a.sent();\n                    _a.label = 4;\n                case 4:\n                    return [3 /*break*/, 9];\n                case 5:\n                    if (!(expires !== undefined)) return [3 /*break*/, 7];\n                    return [\n                        4 /*yield*/,\n                        cookieHandler_1.CookieHandlerReference.getReferenceOrThrow().cookieHandler.setCookie(\n                            \"\"\n                                .concat(name, \"=\")\n                                .concat(cookieVal, \";expires=\")\n                                .concat(expires, \";domain=\")\n                                .concat(scope, \";path=/;samesite=lax\")\n                        ),\n                    ];\n                case 6:\n                    _a.sent();\n                    return [3 /*break*/, 9];\n                case 7:\n                    return [\n                        4 /*yield*/,\n                        cookieHandler_1.CookieHandlerReference.getReferenceOrThrow().cookieHandler.setCookie(\n                            \"\"\n                                .concat(name, \"=\")\n                                .concat(cookieVal, \";domain=\")\n                                .concat(scope, \";expires=Fri, 31 Dec 9999 23:59:59 GMT;path=/;samesite=lax\")\n                        ),\n                    ];\n                case 8:\n                    _a.sent();\n                    _a.label = 9;\n                case 9:\n                    return [2 /*return*/];\n            }\n        });\n    });\n}\nexports.setFrontendCookie = setFrontendCookie;\nfunction getNormalisedUserContext(userContext) {\n    return userContext === undefined ? {} : userContext;\n}\nexports.getNormalisedUserContext = getNormalisedUserContext;\n/**\n * This function handles calling APIs that should only be called once during mount (mostly on mount of a route/feature component).\n * It's split into multiple callbacks (fetch + handleResponse/handleError) because we expect fetch to take longer and\n * and the component may be unmounted during the first fetch, in which case we want to avoid updating state/redirecting.\n * This is especially relevant for development in strict mode with React 18 (and in the future for concurrent rendering).\n *\n * @param fetch This is a callback that is only called once on mount. Mostly it's for consuming tokens/doing one time only API calls\n * @param handleResponse This is called with the result of the first (fetch) call if it succeeds.\n * @param handleError This is called with the error of the first (fetch) call if it rejects.\n * @param startLoading Will start the whole process if this is set to true (or omitted). Mostly used to wait for session loading.\n */\nvar useOnMountAPICall = function (fetch, handleResponse, handleError, startLoading) {\n    if (startLoading === void 0) {\n        startLoading = true;\n    }\n    var consumeReq = (0, react_1.useRef)();\n    var _a = (0, react_1.useState)(undefined),\n        error = _a[0],\n        setError = _a[1];\n    (0, react_1.useEffect)(\n        function () {\n            var effect = function (signal) {\n                return __awaiter(void 0, void 0, void 0, function () {\n                    var resp, err_1;\n                    return __generator(this, function (_a) {\n                        switch (_a.label) {\n                            case 0:\n                                _a.trys.push([0, 2, , 3]);\n                                if (consumeReq.current === undefined) {\n                                    consumeReq.current = fetch();\n                                }\n                                return [4 /*yield*/, consumeReq.current];\n                            case 1:\n                                resp = _a.sent();\n                                if (!signal.aborted) {\n                                    void handleResponse(resp);\n                                }\n                                return [3 /*break*/, 3];\n                            case 2:\n                                err_1 = _a.sent();\n                                if (!signal.aborted) {\n                                    if (handleError !== undefined) {\n                                        handleError(err_1, resp);\n                                    } else {\n                                        setError(err_1);\n                                    }\n                                }\n                                return [3 /*break*/, 3];\n                            case 3:\n                                return [2 /*return*/];\n                        }\n                    });\n                });\n            };\n            if (startLoading) {\n                var ctrl_1 = new AbortController();\n                void effect(ctrl_1.signal);\n                return function () {\n                    ctrl_1.abort();\n                };\n            }\n            return;\n        },\n        [setError, consumeReq, fetch, handleResponse, handleError, startLoading]\n    );\n    if (error) {\n        throw error;\n    }\n};\nexports.useOnMountAPICall = useOnMountAPICall;\nfunction saveInvalidClaimRedirectPathInContext(userContext, invalidClaimRedirectPath) {\n    if (userContext[\"_default\"] === undefined) {\n        userContext[\"_default\"] = {};\n    }\n    if (userContext[\"_default\"].redirectPath === undefined) {\n        userContext[\"_default\"] = __assign(__assign({}, userContext[\"_default\"]), {\n            invalidClaimRedirectPath: invalidClaimRedirectPath,\n        });\n    }\n}\nexports.saveInvalidClaimRedirectPathInContext = saveInvalidClaimRedirectPathInContext;\nfunction popInvalidClaimRedirectPathFromContext(userContext) {\n    var _a;\n    var res = (_a = userContext[\"_default\"]) === null || _a === void 0 ? void 0 : _a.invalidClaimRedirectPath;\n    if (res !== undefined) {\n        delete userContext[\"_default\"].invalidClaimRedirectPath;\n    }\n    return res;\n}\nexports.popInvalidClaimRedirectPathFromContext = popInvalidClaimRedirectPathFromContext;\n"],"mappings":"AAAA,YAAY;;AACZ;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,IAAIA,QAAQ,GACP,IAAI,IAAI,IAAI,CAACA,QAAQ,IACtB,YAAY;EACRA,QAAQ,GACJC,MAAM,CAACC,MAAM,IACb,UAAUC,CAAC,EAAE;IACT,KAAK,IAAIC,CAAC,EAAEC,CAAC,GAAG,CAAC,EAAEC,CAAC,GAAGC,SAAS,CAACC,MAAM,EAAEH,CAAC,GAAGC,CAAC,EAAED,CAAC,EAAE,EAAE;MACjDD,CAAC,GAAGG,SAAS,CAACF,CAAC,CAAC;MAChB,KAAK,IAAII,CAAC,IAAIL,CAAC,EAAE,IAAIH,MAAM,CAACS,SAAS,CAACC,cAAc,CAACC,IAAI,CAACR,CAAC,EAAEK,CAAC,CAAC,EAAEN,CAAC,CAACM,CAAC,CAAC,GAAGL,CAAC,CAACK,CAAC,CAAC;IAChF;IACA,OAAON,CAAC;EACZ,CAAC;EACL,OAAOH,QAAQ,CAACa,KAAK,CAAC,IAAI,EAAEN,SAAS,CAAC;AAC1C,CAAC;AACL,IAAIO,SAAS,GACR,IAAI,IAAI,IAAI,CAACA,SAAS,IACvB,UAAUC,OAAO,EAAEC,UAAU,EAAEC,CAAC,EAAEC,SAAS,EAAE;EACzC,SAASC,KAAK,CAACC,KAAK,EAAE;IAClB,OAAOA,KAAK,YAAYH,CAAC,GACnBG,KAAK,GACL,IAAIH,CAAC,CAAC,UAAUI,OAAO,EAAE;MACrBA,OAAO,CAACD,KAAK,CAAC;IAClB,CAAC,CAAC;EACZ;EACA,OAAO,KAAKH,CAAC,KAAKA,CAAC,GAAGK,OAAO,CAAC,EAAE,UAAUD,OAAO,EAAEE,MAAM,EAAE;IACvD,SAASC,SAAS,CAACJ,KAAK,EAAE;MACtB,IAAI;QACAK,IAAI,CAACP,SAAS,CAACQ,IAAI,CAACN,KAAK,CAAC,CAAC;MAC/B,CAAC,CAAC,OAAOO,CAAC,EAAE;QACRJ,MAAM,CAACI,CAAC,CAAC;MACb;IACJ;IACA,SAASC,QAAQ,CAACR,KAAK,EAAE;MACrB,IAAI;QACAK,IAAI,CAACP,SAAS,CAAC,OAAO,CAAC,CAACE,KAAK,CAAC,CAAC;MACnC,CAAC,CAAC,OAAOO,CAAC,EAAE;QACRJ,MAAM,CAACI,CAAC,CAAC;MACb;IACJ;IACA,SAASF,IAAI,CAACI,MAAM,EAAE;MAClBA,MAAM,CAACC,IAAI,GAAGT,OAAO,CAACQ,MAAM,CAACT,KAAK,CAAC,GAAGD,KAAK,CAACU,MAAM,CAACT,KAAK,CAAC,CAACW,IAAI,CAACP,SAAS,EAAEI,QAAQ,CAAC;IACvF;IACAH,IAAI,CAAC,CAACP,SAAS,GAAGA,SAAS,CAACL,KAAK,CAACE,OAAO,EAAEC,UAAU,IAAI,EAAE,CAAC,EAAEU,IAAI,EAAE,CAAC;EACzE,CAAC,CAAC;AACN,CAAC;AACL,IAAIM,WAAW,GACV,IAAI,IAAI,IAAI,CAACA,WAAW,IACzB,UAAUjB,OAAO,EAAEkB,IAAI,EAAE;EACrB,IAAIC,CAAC,GAAG;MACAC,KAAK,EAAE,CAAC;MACRC,IAAI,EAAE,YAAY;QACd,IAAIjC,CAAC,CAAC,CAAC,CAAC,GAAG,CAAC,EAAE,MAAMA,CAAC,CAAC,CAAC,CAAC;QACxB,OAAOA,CAAC,CAAC,CAAC,CAAC;MACf,CAAC;MACDkC,IAAI,EAAE,EAAE;MACRC,GAAG,EAAE;IACT,CAAC;IACDC,CAAC;IACDC,CAAC;IACDrC,CAAC;IACDsC,CAAC;EACL,OACKA,CAAC,GAAG;IAAEf,IAAI,EAAEgB,IAAI,CAAC,CAAC,CAAC;IAAEC,KAAK,EAAED,IAAI,CAAC,CAAC,CAAC;IAAEE,MAAM,EAAEF,IAAI,CAAC,CAAC;EAAE,CAAC,EACvD,OAAOG,MAAM,KAAK,UAAU,KACvBJ,CAAC,CAACI,MAAM,CAACC,QAAQ,CAAC,GAAG,YAAY;IAC9B,OAAO,IAAI;EACf,CAAC,CAAC,EACNL,CAAC;EAEL,SAASC,IAAI,CAACpC,CAAC,EAAE;IACb,OAAO,UAAUyC,CAAC,EAAE;MAChB,OAAOtB,IAAI,CAAC,CAACnB,CAAC,EAAEyC,CAAC,CAAC,CAAC;IACvB,CAAC;EACL;EACA,SAAStB,IAAI,CAACuB,EAAE,EAAE;IACd,IAAIT,CAAC,EAAE,MAAM,IAAIU,SAAS,CAAC,iCAAiC,CAAC;IAC7D,OAAOf,CAAC,EACJ,IAAI;MACA,IACMK,CAAC,GAAG,CAAC,EACPC,CAAC,KACIrC,CAAC,GACE6C,EAAE,CAAC,CAAC,CAAC,GAAG,CAAC,GACHR,CAAC,CAAC,QAAQ,CAAC,GACXQ,EAAE,CAAC,CAAC,CAAC,GACLR,CAAC,CAAC,OAAO,CAAC,KAAK,CAACrC,CAAC,GAAGqC,CAAC,CAAC,QAAQ,CAAC,KAAKrC,CAAC,CAACS,IAAI,CAAC4B,CAAC,CAAC,EAAE,CAAC,CAAC,GACjDA,CAAC,CAACd,IAAI,CAAC,IACjB,CAAC,CAACvB,CAAC,GAAGA,CAAC,CAACS,IAAI,CAAC4B,CAAC,EAAEQ,EAAE,CAAC,CAAC,CAAC,CAAC,EAAElB,IAAI,EAEhC,OAAO3B,CAAC;MACZ,IAAMqC,CAAC,GAAG,CAAC,EAAGrC,CAAC,EAAG6C,EAAE,GAAG,CAACA,EAAE,CAAC,CAAC,CAAC,GAAG,CAAC,EAAE7C,CAAC,CAACiB,KAAK,CAAC;MAC3C,QAAQ4B,EAAE,CAAC,CAAC,CAAC;QACT,KAAK,CAAC;QACN,KAAK,CAAC;UACF7C,CAAC,GAAG6C,EAAE;UACN;QACJ,KAAK,CAAC;UACFd,CAAC,CAACC,KAAK,EAAE;UACT,OAAO;YAAEf,KAAK,EAAE4B,EAAE,CAAC,CAAC,CAAC;YAAElB,IAAI,EAAE;UAAM,CAAC;QACxC,KAAK,CAAC;UACFI,CAAC,CAACC,KAAK,EAAE;UACTK,CAAC,GAAGQ,EAAE,CAAC,CAAC,CAAC;UACTA,EAAE,GAAG,CAAC,CAAC,CAAC;UACR;QACJ,KAAK,CAAC;UACFA,EAAE,GAAGd,CAAC,CAACI,GAAG,CAACY,GAAG,EAAE;UAChBhB,CAAC,CAACG,IAAI,CAACa,GAAG,EAAE;UACZ;QACJ;UACI,IACI,EAAG/C,CAAC,GAAG+B,CAAC,CAACG,IAAI,EAAIlC,CAAC,GAAGA,CAAC,CAACK,MAAM,GAAG,CAAC,IAAIL,CAAC,CAACA,CAAC,CAACK,MAAM,GAAG,CAAC,CAAE,CAAC,KACrDwC,EAAE,CAAC,CAAC,CAAC,KAAK,CAAC,IAAIA,EAAE,CAAC,CAAC,CAAC,KAAK,CAAC,CAAC,EAC9B;YACEd,CAAC,GAAG,CAAC;YACL;UACJ;UACA,IAAIc,EAAE,CAAC,CAAC,CAAC,KAAK,CAAC,KAAK,CAAC7C,CAAC,IAAK6C,EAAE,CAAC,CAAC,CAAC,GAAG7C,CAAC,CAAC,CAAC,CAAC,IAAI6C,EAAE,CAAC,CAAC,CAAC,GAAG7C,CAAC,CAAC,CAAC,CAAE,CAAC,EAAE;YACvD+B,CAAC,CAACC,KAAK,GAAGa,EAAE,CAAC,CAAC,CAAC;YACf;UACJ;UACA,IAAIA,EAAE,CAAC,CAAC,CAAC,KAAK,CAAC,IAAId,CAAC,CAACC,KAAK,GAAGhC,CAAC,CAAC,CAAC,CAAC,EAAE;YAC/B+B,CAAC,CAACC,KAAK,GAAGhC,CAAC,CAAC,CAAC,CAAC;YACdA,CAAC,GAAG6C,EAAE;YACN;UACJ;UACA,IAAI7C,CAAC,IAAI+B,CAAC,CAACC,KAAK,GAAGhC,CAAC,CAAC,CAAC,CAAC,EAAE;YACrB+B,CAAC,CAACC,KAAK,GAAGhC,CAAC,CAAC,CAAC,CAAC;YACd+B,CAAC,CAACI,GAAG,CAACa,IAAI,CAACH,EAAE,CAAC;YACd;UACJ;UACA,IAAI7C,CAAC,CAAC,CAAC,CAAC,EAAE+B,CAAC,CAACI,GAAG,CAACY,GAAG,EAAE;UACrBhB,CAAC,CAACG,IAAI,CAACa,GAAG,EAAE;UACZ;MAAS;MAEjBF,EAAE,GAAGf,IAAI,CAACrB,IAAI,CAACG,OAAO,EAAEmB,CAAC,CAAC;IAC9B,CAAC,CAAC,OAAOP,CAAC,EAAE;MACRqB,EAAE,GAAG,CAAC,CAAC,EAAErB,CAAC,CAAC;MACXa,CAAC,GAAG,CAAC;IACT,CAAC,SAAS;MACND,CAAC,GAAGpC,CAAC,GAAG,CAAC;IACb;IACJ,IAAI6C,EAAE,CAAC,CAAC,CAAC,GAAG,CAAC,EAAE,MAAMA,EAAE,CAAC,CAAC,CAAC;IAC1B,OAAO;MAAE5B,KAAK,EAAE4B,EAAE,CAAC,CAAC,CAAC,GAAGA,EAAE,CAAC,CAAC,CAAC,GAAG,KAAK,CAAC;MAAElB,IAAI,EAAE;IAAK,CAAC;EACxD;AACJ,CAAC;AACL,IAAIsB,eAAe,GACd,IAAI,IAAI,IAAI,CAACA,eAAe,IAC7B,UAAUC,GAAG,EAAE;EACX,OAAOA,GAAG,IAAIA,GAAG,CAACC,UAAU,GAAGD,GAAG,GAAG;IAAEE,OAAO,EAAEF;EAAI,CAAC;AACzD,CAAC;AACLpD,MAAM,CAACuD,cAAc,CAACC,OAAO,EAAE,YAAY,EAAE;EAAErC,KAAK,EAAE;AAAK,CAAC,CAAC;AAC7DqC,OAAO,CAACC,sCAAsC,GAC1CD,OAAO,CAACE,qCAAqC,GAC7CF,OAAO,CAACG,iBAAiB,GACzBH,OAAO,CAACI,wBAAwB,GAChCJ,OAAO,CAACK,iBAAiB,GACzBL,OAAO,CAACM,cAAc,GACtBN,OAAO,CAACO,qBAAqB,GAC7BP,OAAO,CAACQ,gCAAgC,GACxCR,OAAO,CAACS,YAAY,GACpBT,OAAO,CAACU,sBAAsB,GAC9BV,OAAO,CAACW,eAAe,GACvBX,OAAO,CAACY,eAAe,GACvBZ,OAAO,CAACa,eAAe,GACvBb,OAAO,CAACc,IAAI,GACZd,OAAO,CAACe,mBAAmB,GAC3Bf,OAAO,CAACgB,0BAA0B,GAClChB,OAAO,CAACiB,6BAA6B,GACrCjB,OAAO,CAACkB,sBAAsB,GAC9BlB,OAAO,CAACmB,2BAA2B,GACnCnB,OAAO,CAACoB,YAAY,GACpBpB,OAAO,CAACqB,iCAAiC,GACzCrB,OAAO,CAACsB,MAAM,GACdtB,OAAO,CAACuB,wBAAwB,GAChCvB,OAAO,CAACwB,UAAU,GAClBxB,OAAO,CAACyB,cAAc,GACtBzB,OAAO,CAAC0B,oBAAoB,GAC5B1B,OAAO,CAAC2B,gBAAgB,GACxB3B,OAAO,CAAC4B,qBAAqB,GACzB,KAAK,CAAC;AACd,IAAIC,OAAO,GAAGC,OAAO,CAAC,OAAO,CAAC;AAC9B,IAAIC,WAAW,GAAGD,OAAO,CAAC,aAAa,CAAC;AACxC,IAAIE,eAAe,GAAGF,OAAO,CAAC,yCAAyC,CAAC;AACxE,IAAIG,qBAAqB,GAAGtC,eAAe,CAACmC,OAAO,CAAC,8CAA8C,CAAC,CAAC;AACpG,IAAII,mBAAmB,GAAGvC,eAAe,CAACmC,OAAO,CAAC,4CAA4C,CAAC,CAAC;AAChG,IAAIK,eAAe,GAAGL,OAAO,CAAC,yCAAyC,CAAC;AACxE;AACA;AACA;AACA;AACA;AACA,SAASF,qBAAqB,CAACQ,MAAM,EAAE;EACnC,IAAIC,SAAS,GAAG,IAAIC,eAAe,CAACF,MAAM,CAAC;EAC3C,OAAOC,SAAS,CAACE,GAAG,CAACR,WAAW,CAACS,qBAAqB,CAAC;AAC3D;AACAxC,OAAO,CAAC4B,qBAAqB,GAAGA,qBAAqB;AACrD,SAASD,gBAAgB,CAACc,UAAU,EAAE;EAClC,IAAIC,MAAM,GAAG,IAAIC,GAAG,CAACR,eAAe,CAACS,sBAAsB,CAACC,mBAAmB,EAAE,CAACC,aAAa,CAACC,QAAQ,CAACC,OAAO,EAAE,CAAC;EACnH,KAAK,IAAIC,EAAE,GAAG,CAAC,EAAEC,YAAY,GAAGT,UAAU,EAAEQ,EAAE,GAAGC,YAAY,CAACnG,MAAM,EAAEkG,EAAE,EAAE,EAAE;IACxE,IAAIE,KAAK,GAAGD,YAAY,CAACD,EAAE,CAAC;IAC5BP,MAAM,CAACU,YAAY,CAACC,MAAM,CAACF,KAAK,CAAC;EACrC;EACAhB,eAAe,CAACS,sBAAsB,CAACC,mBAAmB,EAAE,CAACC,aAAa,CAACQ,OAAO,CAACC,YAAY,CAC3FpB,eAAe,CAACS,sBAAsB,CAACC,mBAAmB,EAAE,CAACC,aAAa,CAACQ,OAAO,CAACE,QAAQ,EAAE,EAC7F,EAAE,EACFrB,eAAe,CAACS,sBAAsB,CAACC,mBAAmB,EAAE,CAACC,aAAa,CAACC,QAAQ,CAACC,OAAO,EAAE,CAChG;AACL;AACAhD,OAAO,CAAC2B,gBAAgB,GAAGA,gBAAgB;AAC3C,SAASD,oBAAoB,GAAG;EAC5BC,gBAAgB,CAAC,CAAC,OAAO,EAAE,SAAS,CAAC,CAAC;AAC1C;AACA3B,OAAO,CAAC0B,oBAAoB,GAAGA,oBAAoB;AACnD,SAASD,cAAc,CAAC0B,KAAK,EAAE;EAC3B,IAAId,SAAS,GAAG,IAAIC,eAAe,CAC/BH,eAAe,CAACS,sBAAsB,CAACC,mBAAmB,EAAE,CAACC,aAAa,CAACC,QAAQ,CAACU,SAAS,EAAE,CAClG;EACD,OAAOpB,SAAS,CAACE,GAAG,CAACY,KAAK,CAAC;AAC/B;AACAnD,OAAO,CAACyB,cAAc,GAAGA,cAAc;AACvC,SAASD,UAAU,GAAG;EAClB;EACA,OAAOW,eAAe,CAACS,sBAAsB,CAACC,mBAAmB,EAAE,CAACC,aAAa,CAACC,QAAQ,CAACW,OAAO,EAAE,CAACC,MAAM,CAAC,CAAC,CAAC;AAClH;AACA3D,OAAO,CAACwB,UAAU,GAAGA,UAAU;AAC/B,SAASD,wBAAwB,GAAG;EAChC,IAAI4B,KAAK,GAAG1B,cAAc,CAAC,gBAAgB,CAAC;EAC5C,IAAI0B,KAAK,KAAK,IAAI,EAAE;IAChB,OAAOS,SAAS;EACpB,CAAC,MAAM;IACH;IACA,IAAI;MACA,OAAO,IAAI1B,mBAAmB,CAACpC,OAAO,CAACqD,KAAK,CAAC,CAACU,oBAAoB,EAAE;IACxE,CAAC,CAAC,OAAOC,EAAE,EAAE;MACT,OAAOF,SAAS;IACpB;EACJ;AACJ;AACA5D,OAAO,CAACuB,wBAAwB,GAAGA,wBAAwB;AAC3D;AACA;AACA;AACA,SAASD,MAAM,GAAG;EACd,IAAI;IACA,OAAOyC,OAAO,CAACC,GAAG,CAACC,SAAS,KAAK,SAAS;EAC9C,CAAC,CAAC,OAAOC,GAAG,EAAE;IACV;IACA,OAAO,KAAK;EAChB;AACJ;AACAlE,OAAO,CAACsB,MAAM,GAAGA,MAAM;AACvB,SAASD,iCAAiC,CAAC8C,OAAO,EAAE;EAChD,IAAIA,OAAO,KAAKP,SAAS,EAAE;IACvB,MAAM,IAAIQ,KAAK,CAAC,iEAAiE,CAAC;EACtF;EACA,IAAID,OAAO,CAACE,SAAS,KAAKT,SAAS,EAAE;IACjC,MAAM,IAAIQ,KAAK,CAAC,uFAAuF,CAAC;EAC5G;EACA,IAAID,OAAO,CAACG,OAAO,KAAKV,SAAS,EAAE;IAC/B,MAAM,IAAIQ,KAAK,CAAC,qFAAqF,CAAC;EAC1G;EACA,IAAID,OAAO,CAACI,aAAa,KAAKX,SAAS,EAAE;IACrC,MAAM,IAAIQ,KAAK,CAAC,2FAA2F,CAAC;EAChH;EACA,IAAII,cAAc,GAAG,IAAItC,mBAAmB,CAACpC,OAAO,CAAC,EAAE,CAAC;EACxD,IAAIqE,OAAO,CAACK,cAAc,KAAKZ,SAAS,EAAE;IACtCY,cAAc,GAAG,IAAItC,mBAAmB,CAACpC,OAAO,CAACqE,OAAO,CAACK,cAAc,CAAC;EAC5E;EACA,OAAO;IACHF,OAAO,EAAEH,OAAO,CAACG,OAAO;IACxBD,SAAS,EAAE,IAAIpC,qBAAqB,CAACnC,OAAO,CAACqE,OAAO,CAACE,SAAS,CAAC;IAC/DE,aAAa,EAAE,IAAItC,qBAAqB,CAACnC,OAAO,CAACqE,OAAO,CAACI,aAAa,CAAC;IACvEE,WAAW,EAAED,cAAc,CAACE,UAAU,CAClCC,6BAA6B,CAAC5C,WAAW,CAAC6C,qBAAqB,EAAET,OAAO,CAACM,WAAW,CAAC,CACxF;IACDI,eAAe,EAAEF,6BAA6B,CAAC5C,WAAW,CAAC+C,yBAAyB,EAAEX,OAAO,CAACU,eAAe;EACjH,CAAC;AACL;AACA7E,OAAO,CAACqB,iCAAiC,GAAGA,iCAAiC;AAC7E,SAASsD,6BAA6B,CAACI,WAAW,EAAEC,IAAI,EAAE;EACtD,IAAIA,IAAI,KAAKpB,SAAS,EAAE;IACpB,OAAO,IAAI1B,mBAAmB,CAACpC,OAAO,CAACkF,IAAI,CAAC;EAChD,CAAC,MAAM;IACH,OAAO,IAAI9C,mBAAmB,CAACpC,OAAO,CAACiF,WAAW,CAAC;EACvD;AACJ;AACA;AACA;AACA;AACA;AACA;AACA,SAAS3D,YAAY,CAAC6D,MAAM,EAAEC,gBAAgB,EAAE;EAC5C,OAAO7H,SAAS,CAAC,IAAI,EAAE,KAAK,CAAC,EAAE,KAAK,CAAC,EAAE,YAAY;IAC/C,IAAI8H,gBAAgB,EAAEC,OAAO,EAAExI,CAAC;IAChC,OAAO2B,WAAW,CAAC,IAAI,EAAE,UAAUuF,EAAE,EAAE;MACnC,QAAQA,EAAE,CAACpF,KAAK;QACZ,KAAK,CAAC;UACFyG,gBAAgB,GAAG,EAAE;UACrB,IAAID,gBAAgB,CAACnI,MAAM,KAAKkI,MAAM,CAAClI,MAAM,EAAE;YAC3C,MAAMqH,KAAK,CAAC,gDAAgD,CAAC;UACjE;UACAgB,OAAO,GAAG,UAAUxI,CAAC,EAAE;YACnB,IAAIyI,KAAK,EAAEC,KAAK,EAAE3H,KAAK,EAAE4H,KAAK;YAC9B,OAAOhH,WAAW,CAAC,IAAI,EAAE,UAAUiH,EAAE,EAAE;cACnC,QAAQA,EAAE,CAAC9G,KAAK;gBACZ,KAAK,CAAC;kBACF2G,KAAK,GAAGH,gBAAgB,CAACtI,CAAC,CAAC;kBAC3B0I,KAAK,GAAGL,MAAM,CAACQ,IAAI,CAAC,UAAU7I,CAAC,EAAE;oBAC7B,OAAOA,CAAC,CAAC8I,EAAE,KAAKL,KAAK,CAACK,EAAE;kBAC5B,CAAC,CAAC;kBACF/H,KAAK,GAAG2H,KAAK,CAAC3H,KAAK;kBACnB,IAAI2H,KAAK,CAACI,EAAE,KAAK,OAAO,EAAE;oBACtB/H,KAAK,GAAGA,KAAK,CAACgI,IAAI,EAAE;kBACxB;kBACA,OAAO,CAAC,CAAC,CAAC,WAAWN,KAAK,CAACO,QAAQ,CAACjI,KAAK,CAAC,CAAC;gBAC/C,KAAK,CAAC;kBACF4H,KAAK,GAAGC,EAAE,CAAC7G,IAAI,EAAE;kBACjB;kBACA,IAAI4G,KAAK,KAAK3B,SAAS,EAAE;oBACrBuB,gBAAgB,CAACzF,IAAI,CAAC;sBAClB6F,KAAK,EAAEA,KAAK;sBACZG,EAAE,EAAEL,KAAK,CAACK;oBACd,CAAC,CAAC;kBACN;kBACA,OAAO,CAAC,CAAC,CAAC,WAAW;cAAC;YAElC,CAAC,CAAC;UACN,CAAC;;UACD9I,CAAC,GAAG,CAAC;UACLkH,EAAE,CAACpF,KAAK,GAAG,CAAC;QAChB,KAAK,CAAC;UACF,IAAI,EAAE9B,CAAC,GAAGsI,gBAAgB,CAACnI,MAAM,CAAC,EAAE,OAAO,CAAC,CAAC,CAAC,WAAW,CAAC,CAAC;UAC3D,OAAO,CAAC,CAAC,CAAC,YAAYqI,OAAO,CAACxI,CAAC,CAAC,CAAC;QACrC,KAAK,CAAC;UACFkH,EAAE,CAACnF,IAAI,EAAE;UACTmF,EAAE,CAACpF,KAAK,GAAG,CAAC;QAChB,KAAK,CAAC;UACF9B,CAAC,EAAE;UACH,OAAO,CAAC,CAAC,CAAC,WAAW,CAAC,CAAC;QAC3B,KAAK,CAAC;UACF,OAAO,CAAC,CAAC,CAAC,YAAYuI,gBAAgB,CAAC;MAAC;IAEpD,CAAC,CAAC;EACN,CAAC,CAAC;AACN;AACAnF,OAAO,CAACoB,YAAY,GAAGA,YAAY;AACnC;AACA;AACA;AACA,SAASD,2BAA2B,GAAG;EACnC,OAAO,IAAIe,mBAAmB,CAACpC,OAAO,CAClCqC,eAAe,CAACS,sBAAsB,CAACC,mBAAmB,EAAE,CAACC,aAAa,CAACC,QAAQ,CAAC8C,WAAW,EAAE,CACpG;AACL;AACA7F,OAAO,CAACmB,2BAA2B,GAAGA,2BAA2B;AACjE,SAASD,sBAAsB,CAAC4E,SAAS,EAAEC,WAAW,EAAE;EACpD,IAAIA,WAAW,KAAKnC,SAAS,EAAE;IAC3B,OAAOkC,SAAS;EACpB;EACA,IAAI;IACA,IAAIE,KAAK,GAAG,IAAIrD,GAAG,CAACmD,SAAS,CAAC;IAC9BtJ,MAAM,CAACyJ,OAAO,CAACF,WAAW,CAAC,CAACG,OAAO,CAAC,UAAUpC,EAAE,EAAE;MAC9C,IAAIqC,GAAG,GAAGrC,EAAE,CAAC,CAAC,CAAC;QACXnG,KAAK,GAAGmG,EAAE,CAAC,CAAC,CAAC;MACjBkC,KAAK,CAAC5C,YAAY,CAACgD,GAAG,CAACD,GAAG,EAAExI,KAAK,CAAC;IACtC,CAAC,CAAC;IACF,OAAOqI,KAAK,CAACK,IAAI;EACrB,CAAC,CAAC,OAAOnI,CAAC,EAAE;IACR,IAAIoI,UAAU,GAAGR,SAAS,CAACS,UAAU,CAAC,GAAG,CAAC,GAAG,gBAAgB,GAAG,mBAAmB;IACnF,IAAIC,KAAK,GAAG,IAAI7D,GAAG,CAAC,EAAE,CAAC8D,MAAM,CAACH,UAAU,CAAC,CAACG,MAAM,CAACX,SAAS,CAAC,CAAC;IAC5DtJ,MAAM,CAACyJ,OAAO,CAACF,WAAW,CAAC,CAACG,OAAO,CAAC,UAAUpC,EAAE,EAAE;MAC9C,IAAIqC,GAAG,GAAGrC,EAAE,CAAC,CAAC,CAAC;QACXnG,KAAK,GAAGmG,EAAE,CAAC,CAAC,CAAC;MACjB0C,KAAK,CAACpD,YAAY,CAACgD,GAAG,CAACD,GAAG,EAAExI,KAAK,CAAC;IACtC,CAAC,CAAC;IACF,OAAO,EAAE,CAAC8I,MAAM,CAACD,KAAK,CAACE,QAAQ,CAAC,CAACD,MAAM,CAACD,KAAK,CAACpE,MAAM,CAAC;EACzD;AACJ;AACApC,OAAO,CAACkB,sBAAsB,GAAGA,sBAAsB;AACvD;AACA;AACA;AACA,SAASD,6BAA6B,CAAC0F,QAAQ,EAAE;EAC7C,OAAO,YAAY;IACf,IAAIC,kBAAkB,GAAGhF,qBAAqB,CAC1CO,eAAe,CAACS,sBAAsB,CAACC,mBAAmB,EAAE,CAACC,aAAa,CAACC,QAAQ,CAACU,SAAS,EAAE,CAClG;IACD,OAAOmD,kBAAkB,KAAKD,QAAQ;EAC1C,CAAC;AACL;AACA3G,OAAO,CAACiB,6BAA6B,GAAGA,6BAA6B;AACrE,SAASD,0BAA0B,CAAC6F,EAAE,EAAE;EACpC,IAAIA,EAAE,CAAClB,IAAI,EAAE,KAAK,EAAE,EAAE;IAClBkB,EAAE,GAAG,GAAG;EACZ;EACA1E,eAAe,CAACS,sBAAsB,CAACC,mBAAmB,EAAE,CAACC,aAAa,CAACC,QAAQ,CAAC+D,OAAO,CAACD,EAAE,CAAC;AACnG;AACA7G,OAAO,CAACgB,0BAA0B,GAAGA,0BAA0B;AAC/D,SAASD,mBAAmB,CAAC8F,EAAE,EAAEvD,OAAO,EAAE;EACtC,IAAIuD,EAAE,CAAClB,IAAI,EAAE,KAAK,EAAE,EAAE;IAClBkB,EAAE,GAAG,GAAG;EACZ;EACA,IAAIvD,OAAO,CAAC5D,IAAI,KAAKkE,SAAS,EAAE;IAC5B;IACAN,OAAO,CAAC5D,IAAI,CAACmH,EAAE,CAAC;EACpB,CAAC,MAAM;IACH;IACA;IACAvD,OAAO,CAACuD,EAAE,CAAC;EACf;AACJ;AACA7G,OAAO,CAACe,mBAAmB,GAAGA,mBAAmB;AACjD,SAASD,IAAI,GAAG;EACZ,OACIqB,eAAe,CAACS,sBAAsB,CAACC,mBAAmB,EAAE,CAACC,aAAa,CAACiE,WAAW,EAAE,CAACC,YAAY,KACrGpD,SAAS;AAEjB;AACA5D,OAAO,CAACc,IAAI,GAAGA,IAAI;AACnB,SAASD,eAAe,GAAG;EACvB,OAAO,IAAIoB,qBAAqB,CAACnC,OAAO,CACpCqC,eAAe,CAACS,sBAAsB,CAACC,mBAAmB,EAAE,CAACC,aAAa,CAACC,QAAQ,CAACkE,SAAS,EAAE,CAClG;AACL;AACAjH,OAAO,CAACa,eAAe,GAAGA,eAAe;AACzC,SAASD,eAAe,CAACuF,GAAG,EAAE;EAC1B,OAAO9I,SAAS,CAAC,IAAI,EAAE,KAAK,CAAC,EAAE,KAAK,CAAC,EAAE,YAAY;IAC/C,IAAI6J,GAAG;IACP,OAAO3I,WAAW,CAAC,IAAI,EAAE,UAAUuF,EAAE,EAAE;MACnCoD,GAAG,GAAG/E,eAAe,CAACS,sBAAsB,CAACC,mBAAmB,EAAE,CAACC,aAAa,CAACqE,YAAY,CAACC,OAAO,CAACjB,GAAG,CAAC;MAC1G,IAAIe,GAAG,KAAK,IAAI,IAAIA,GAAG,KAAKtD,SAAS,EAAE;QACnC,OAAO,CAAC,CAAC,CAAC,YAAY,IAAI,CAAC;MAC/B;MACA,OAAO,CAAC,CAAC,CAAC,YAAYsD,GAAG,CAAC;IAC9B,CAAC,CAAC;EACN,CAAC,CAAC;AACN;AACAlH,OAAO,CAACY,eAAe,GAAGA,eAAe;AACzC,SAASD,eAAe,CAACwF,GAAG,EAAExI,KAAK,EAAE;EACjC,OAAON,SAAS,CAAC,IAAI,EAAE,KAAK,CAAC,EAAE,KAAK,CAAC,EAAE,YAAY;IAC/C,OAAOkB,WAAW,CAAC,IAAI,EAAE,UAAUuF,EAAE,EAAE;MACnC,QAAQA,EAAE,CAACpF,KAAK;QACZ,KAAK,CAAC;UACF,OAAO,CACH,CAAC,CAAC,WACFyD,eAAe,CAACS,sBAAsB,CAACC,mBAAmB,EAAE,CAACC,aAAa,CAACqE,YAAY,CAACE,OAAO,CAC3FlB,GAAG,EACHxI,KAAK,CACR,CACJ;QACL,KAAK,CAAC;UACFmG,EAAE,CAACnF,IAAI,EAAE;UACT,OAAO,CAAC,CAAC,CAAC,WAAW;MAAC;IAElC,CAAC,CAAC;EACN,CAAC,CAAC;AACN;;AACAqB,OAAO,CAACW,eAAe,GAAGA,eAAe;AACzC,SAASD,sBAAsB,CAACyF,GAAG,EAAE;EACjC,OAAO9I,SAAS,CAAC,IAAI,EAAE,KAAK,CAAC,EAAE,KAAK,CAAC,EAAE,YAAY;IAC/C,OAAOkB,WAAW,CAAC,IAAI,EAAE,UAAUuF,EAAE,EAAE;MACnC,QAAQA,EAAE,CAACpF,KAAK;QACZ,KAAK,CAAC;UACF,OAAO,CACH,CAAC,CAAC,WACFyD,eAAe,CAACS,sBAAsB,CAACC,mBAAmB,EAAE,CAACC,aAAa,CAACqE,YAAY,CAACG,UAAU,CAC9FnB,GAAG,CACN,CACJ;QACL,KAAK,CAAC;UACFrC,EAAE,CAACnF,IAAI,EAAE;UACT,OAAO,CAAC,CAAC,CAAC,WAAW;MAAC;IAElC,CAAC,CAAC;EACN,CAAC,CAAC;AACN;;AACAqB,OAAO,CAACU,sBAAsB,GAAGA,sBAAsB;AACvD,SAASD,YAAY,CAAC8G,IAAI,EAAEC,IAAI,EAAE;EAC9B,IAAIN,GAAG,GAAG3K,QAAQ,CAAC,CAAC,CAAC,EAAEgL,IAAI,CAAC;EAC5B,KAAK,IAAIpB,GAAG,IAAIqB,IAAI,EAAE;IAClB,IAAI,OAAON,GAAG,CAACf,GAAG,CAAC,KAAK,QAAQ,IAAI,OAAOqB,IAAI,CAACrB,GAAG,CAAC,KAAK,QAAQ,EAAE;MAC/De,GAAG,CAACf,GAAG,CAAC,GAAG1F,YAAY,CAACyG,GAAG,CAACf,GAAG,CAAC,EAAEqB,IAAI,CAACrB,GAAG,CAAC,CAAC;IAChD,CAAC,MAAM;MACHe,GAAG,CAACf,GAAG,CAAC,GAAGqB,IAAI,CAACrB,GAAG,CAAC;IACxB;EACJ;EACA,OAAOe,GAAG;AACd;AACAlH,OAAO,CAACS,YAAY,GAAGA,YAAY;AACnC,SAASD,gCAAgC,CAACiH,WAAW,EAAE;EACnD,SAASC,MAAM,CAACC,YAAY,EAAE;IAC1BA,YAAY,GAAGA,YAAY,CAAChC,IAAI,EAAE,CAACiC,WAAW,EAAE;IAChD;IACA,IAAID,YAAY,CAACpB,UAAU,CAAC,GAAG,CAAC,EAAE;MAC9BoB,YAAY,GAAGA,YAAY,CAAChE,MAAM,CAAC,CAAC,CAAC;IACzC;IACA,IAAI,CAACgE,YAAY,CAACpB,UAAU,CAAC,SAAS,CAAC,IAAI,CAACoB,YAAY,CAACpB,UAAU,CAAC,UAAU,CAAC,EAAE;MAC7EoB,YAAY,GAAG,SAAS,GAAGA,YAAY;IAC3C;IACA,IAAI;MACA,IAAIE,MAAM,GAAG,IAAIlF,GAAG,CAACgF,YAAY,CAAC;MAClCA,YAAY,GAAGE,MAAM,CAACC,QAAQ;MAC9B;MACA,IAAIH,YAAY,CAACpB,UAAU,CAAC,GAAG,CAAC,EAAE;QAC9BoB,YAAY,GAAGA,YAAY,CAAChE,MAAM,CAAC,CAAC,CAAC;MACzC;MACA,OAAOgE,YAAY;IACvB,CAAC,CAAC,OAAOzD,GAAG,EAAE;MACV,MAAM,IAAIE,KAAK,CAAC,qCAAqC,CAAC;IAC1D;EACJ;EACA,SAAS2D,aAAa,CAACC,SAAS,EAAE;IAC9B,OAAO,kKAAkK,CAACC,IAAI,CAC1KD,SAAS,CACZ;EACL;EACA,IAAIE,eAAe,GAAGR,MAAM,CAACD,WAAW,CAAC;EACzC,IAAIS,eAAe,KAAK,WAAW,IAAIH,aAAa,CAACG,eAAe,CAAC,EAAE;IACnE,OAAOA,eAAe;EAC1B;EACA,IAAIT,WAAW,CAAClB,UAAU,CAAC,GAAG,CAAC,EAAE;IAC7B,OAAO,GAAG,GAAG2B,eAAe;EAChC;EACA,OAAOA,eAAe;AAC1B;AACAlI,OAAO,CAACQ,gCAAgC,GAAGA,gCAAgC;AAC3E,SAASD,qBAAqB,GAAG;EAC7B,IAAI;IACA,OAAOC,gCAAgC,CACnC2B,eAAe,CAACS,sBAAsB,CAACC,mBAAmB,EAAE,CAACC,aAAa,CAACC,QAAQ,CAACoF,WAAW,EAAE,CACpG;EACL,CAAC,CAAC,OAAOrE,EAAE,EAAE;IACT,OAAOF,SAAS;EACpB;AACJ;AACA5D,OAAO,CAACO,qBAAqB,GAAGA,qBAAqB;AACrD,SAASD,cAAc,CAAC8H,IAAI,EAAE;EAC1B,OAAO/K,SAAS,CAAC,IAAI,EAAE,KAAK,CAAC,EAAE,KAAK,CAAC,EAAE,YAAY;IAC/C,IAAIM,KAAK,EAAEmG,EAAE,EAAEuE,KAAK,EAAEC,IAAI,EAAEC,IAAI;IAChC,OAAOhK,WAAW,CAAC,IAAI,EAAE,UAAUiH,EAAE,EAAE;MACnC,QAAQA,EAAE,CAAC9G,KAAK;QACZ,KAAK,CAAC;UACFoF,EAAE,GAAG,IAAI;UACT,OAAO,CACH,CAAC,CAAC,WACF9B,eAAe,CAACwG,sBAAsB,CAAC3F,mBAAmB,EAAE,CAAC4F,aAAa,CAACC,SAAS,EAAE,CACzF;QACL,KAAK,CAAC;UACF/K,KAAK,GAAGmG,EAAE,GAAG0B,EAAE,CAAC7G,IAAI,EAAE;UACtB0J,KAAK,GAAG1K,KAAK,CAACgL,KAAK,CAAC,IAAI,GAAGP,IAAI,GAAG,GAAG,CAAC;UACtC,IAAIC,KAAK,CAACtL,MAAM,IAAI,CAAC,EAAE;YACnBuL,IAAI,GAAGD,KAAK,CAAC5I,GAAG,EAAE;YAClB,IAAI6I,IAAI,KAAK1E,SAAS,EAAE;cACpB2E,IAAI,GAAGD,IAAI,CAACK,KAAK,CAAC,GAAG,CAAC,CAACC,KAAK,EAAE;cAC9B,IAAIL,IAAI,KAAK3E,SAAS,EAAE;gBACpB,OAAO,CAAC,CAAC,CAAC,YAAY,IAAI,CAAC;cAC/B;cACA,OAAO,CAAC,CAAC,CAAC,YAAY2E,IAAI,CAAC;YAC/B;UACJ;UACA,OAAO,CAAC,CAAC,CAAC,YAAY,IAAI,CAAC;MAAC;IAExC,CAAC,CAAC;EACN,CAAC,CAAC;AACN;AACAvI,OAAO,CAACM,cAAc,GAAGA,cAAc;AACvC;AACA,SAASD,iBAAiB,CAAC+H,IAAI,EAAEzK,KAAK,EAAEkL,KAAK,EAAE;EAC3C,OAAOxL,SAAS,CAAC,IAAI,EAAE,KAAK,CAAC,EAAE,KAAK,CAAC,EAAE,YAAY;IAC/C,IAAIyL,OAAO,EAAEC,SAAS;IACtB,OAAOxK,WAAW,CAAC,IAAI,EAAE,UAAUuF,EAAE,EAAE;MACnC,QAAQA,EAAE,CAACpF,KAAK;QACZ,KAAK,CAAC;UACFoK,OAAO,GAAG,+BAA+B;UACzCC,SAAS,GAAG,EAAE;UACd,IAAIpL,KAAK,KAAKiG,SAAS,EAAE;YACrBmF,SAAS,GAAGpL,KAAK;YACjBmL,OAAO,GAAGlF,SAAS,CAAC,CAAC;UACzB;;UACA,IACI,EACIiF,KAAK,KAAK,WAAW,IACrBA,KAAK,KACD1G,eAAe,CAACS,sBAAsB,CAACC,mBAAmB,EAAE,CAACC,aAAa,CAACC,QAAQ,CAACoF,WAAW,EAAE,IACrGU,KAAK,KAAKjF,SAAS,CACtB,EAED,OAAO,CAAC,CAAC,CAAC,WAAW,CAAC,CAAC;UAC3B,IAAI,EAAEkF,OAAO,KAAKlF,SAAS,CAAC,EAAE,OAAO,CAAC,CAAC,CAAC,WAAW,CAAC,CAAC;UACrD,OAAO,CACH,CAAC,CAAC,WACF5B,eAAe,CAACwG,sBAAsB,CAAC3F,mBAAmB,EAAE,CAAC4F,aAAa,CAACO,SAAS,CAChF,EAAE,CAACvC,MAAM,CAAC2B,IAAI,EAAE,GAAG,CAAC,CAAC3B,MAAM,CAACsC,SAAS,EAAE,WAAW,CAAC,CAACtC,MAAM,CAACqC,OAAO,EAAE,sBAAsB,CAAC,CAC9F,CACJ;QACL,KAAK,CAAC;UACFhF,EAAE,CAACnF,IAAI,EAAE;UACT,OAAO,CAAC,CAAC,CAAC,WAAW,CAAC,CAAC;QAC3B,KAAK,CAAC;UACF,OAAO,CACH,CAAC,CAAC,WACFqD,eAAe,CAACwG,sBAAsB,CAAC3F,mBAAmB,EAAE,CAAC4F,aAAa,CAACO,SAAS,CAChF,EAAE,CACGvC,MAAM,CAAC2B,IAAI,EAAE,GAAG,CAAC,CACjB3B,MAAM,CAACsC,SAAS,EAAE,4DAA4D,CAAC,CACvF,CACJ;QACL,KAAK,CAAC;UACFjF,EAAE,CAACnF,IAAI,EAAE;UACTmF,EAAE,CAACpF,KAAK,GAAG,CAAC;QAChB,KAAK,CAAC;UACF,OAAO,CAAC,CAAC,CAAC,WAAW,CAAC,CAAC;QAC3B,KAAK,CAAC;UACF,IAAI,EAAEoK,OAAO,KAAKlF,SAAS,CAAC,EAAE,OAAO,CAAC,CAAC,CAAC,WAAW,CAAC,CAAC;UACrD,OAAO,CACH,CAAC,CAAC,WACF5B,eAAe,CAACwG,sBAAsB,CAAC3F,mBAAmB,EAAE,CAAC4F,aAAa,CAACO,SAAS,CAChF,EAAE,CACGvC,MAAM,CAAC2B,IAAI,EAAE,GAAG,CAAC,CACjB3B,MAAM,CAACsC,SAAS,EAAE,WAAW,CAAC,CAC9BtC,MAAM,CAACqC,OAAO,EAAE,UAAU,CAAC,CAC3BrC,MAAM,CAACoC,KAAK,EAAE,sBAAsB,CAAC,CAC7C,CACJ;QACL,KAAK,CAAC;UACF/E,EAAE,CAACnF,IAAI,EAAE;UACT,OAAO,CAAC,CAAC,CAAC,WAAW,CAAC,CAAC;QAC3B,KAAK,CAAC;UACF,OAAO,CACH,CAAC,CAAC,WACFqD,eAAe,CAACwG,sBAAsB,CAAC3F,mBAAmB,EAAE,CAAC4F,aAAa,CAACO,SAAS,CAChF,EAAE,CACGvC,MAAM,CAAC2B,IAAI,EAAE,GAAG,CAAC,CACjB3B,MAAM,CAACsC,SAAS,EAAE,UAAU,CAAC,CAC7BtC,MAAM,CAACoC,KAAK,EAAE,4DAA4D,CAAC,CACnF,CACJ;QACL,KAAK,CAAC;UACF/E,EAAE,CAACnF,IAAI,EAAE;UACTmF,EAAE,CAACpF,KAAK,GAAG,CAAC;QAChB,KAAK,CAAC;UACF,OAAO,CAAC,CAAC,CAAC,WAAW;MAAC;IAElC,CAAC,CAAC;EACN,CAAC,CAAC;AACN;;AACAsB,OAAO,CAACK,iBAAiB,GAAGA,iBAAiB;AAC7C,SAASD,wBAAwB,CAAC6I,WAAW,EAAE;EAC3C,OAAOA,WAAW,KAAKrF,SAAS,GAAG,CAAC,CAAC,GAAGqF,WAAW;AACvD;AACAjJ,OAAO,CAACI,wBAAwB,GAAGA,wBAAwB;AAC3D;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,IAAID,iBAAiB,GAAG,UAAU+I,KAAK,EAAEC,cAAc,EAAEC,WAAW,EAAEC,YAAY,EAAE;EAChF,IAAIA,YAAY,KAAK,KAAK,CAAC,EAAE;IACzBA,YAAY,GAAG,IAAI;EACvB;EACA,IAAIC,UAAU,GAAG,CAAC,CAAC,EAAEzH,OAAO,CAAC0H,MAAM,GAAG;EACtC,IAAIzF,EAAE,GAAG,CAAC,CAAC,EAAEjC,OAAO,CAAC2H,QAAQ,EAAE5F,SAAS,CAAC;IACrC2B,KAAK,GAAGzB,EAAE,CAAC,CAAC,CAAC;IACb2F,QAAQ,GAAG3F,EAAE,CAAC,CAAC,CAAC;EACpB,CAAC,CAAC,EAAEjC,OAAO,CAAC6H,SAAS,EACjB,YAAY;IACR,IAAIC,MAAM,GAAG,UAAUC,MAAM,EAAE;MAC3B,OAAOvM,SAAS,CAAC,KAAK,CAAC,EAAE,KAAK,CAAC,EAAE,KAAK,CAAC,EAAE,YAAY;QACjD,IAAIwM,IAAI,EAAEC,KAAK;QACf,OAAOvL,WAAW,CAAC,IAAI,EAAE,UAAUuF,EAAE,EAAE;UACnC,QAAQA,EAAE,CAACpF,KAAK;YACZ,KAAK,CAAC;cACFoF,EAAE,CAAClF,IAAI,CAACc,IAAI,CAAC,CAAC,CAAC,EAAE,CAAC,GAAI,CAAC,CAAC,CAAC;cACzB,IAAI4J,UAAU,CAACS,OAAO,KAAKnG,SAAS,EAAE;gBAClC0F,UAAU,CAACS,OAAO,GAAGb,KAAK,EAAE;cAChC;cACA,OAAO,CAAC,CAAC,CAAC,WAAWI,UAAU,CAACS,OAAO,CAAC;YAC5C,KAAK,CAAC;cACFF,IAAI,GAAG/F,EAAE,CAACnF,IAAI,EAAE;cAChB,IAAI,CAACiL,MAAM,CAACI,OAAO,EAAE;gBACjB,KAAKb,cAAc,CAACU,IAAI,CAAC;cAC7B;cACA,OAAO,CAAC,CAAC,CAAC,WAAW,CAAC,CAAC;YAC3B,KAAK,CAAC;cACFC,KAAK,GAAGhG,EAAE,CAACnF,IAAI,EAAE;cACjB,IAAI,CAACiL,MAAM,CAACI,OAAO,EAAE;gBACjB,IAAIZ,WAAW,KAAKxF,SAAS,EAAE;kBAC3BwF,WAAW,CAACU,KAAK,EAAED,IAAI,CAAC;gBAC5B,CAAC,MAAM;kBACHJ,QAAQ,CAACK,KAAK,CAAC;gBACnB;cACJ;cACA,OAAO,CAAC,CAAC,CAAC,WAAW,CAAC,CAAC;YAC3B,KAAK,CAAC;cACF,OAAO,CAAC,CAAC,CAAC,WAAW;UAAC;QAElC,CAAC,CAAC;MACN,CAAC,CAAC;IACN,CAAC;;IACD,IAAIT,YAAY,EAAE;MACd,IAAIY,MAAM,GAAG,IAAIC,eAAe,EAAE;MAClC,KAAKP,MAAM,CAACM,MAAM,CAACL,MAAM,CAAC;MAC1B,OAAO,YAAY;QACfK,MAAM,CAACE,KAAK,EAAE;MAClB,CAAC;IACL;IACA;EACJ,CAAC,EACD,CAACV,QAAQ,EAAEH,UAAU,EAAEJ,KAAK,EAAEC,cAAc,EAAEC,WAAW,EAAEC,YAAY,CAAC,CAC3E;EACD,IAAI9D,KAAK,EAAE;IACP,MAAMA,KAAK;EACf;AACJ,CAAC;AACDvF,OAAO,CAACG,iBAAiB,GAAGA,iBAAiB;AAC7C,SAASD,qCAAqC,CAAC+I,WAAW,EAAEmB,wBAAwB,EAAE;EAClF,IAAInB,WAAW,CAAC,UAAU,CAAC,KAAKrF,SAAS,EAAE;IACvCqF,WAAW,CAAC,UAAU,CAAC,GAAG,CAAC,CAAC;EAChC;EACA,IAAIA,WAAW,CAAC,UAAU,CAAC,CAACoB,YAAY,KAAKzG,SAAS,EAAE;IACpDqF,WAAW,CAAC,UAAU,CAAC,GAAG1M,QAAQ,CAACA,QAAQ,CAAC,CAAC,CAAC,EAAE0M,WAAW,CAAC,UAAU,CAAC,CAAC,EAAE;MACtEmB,wBAAwB,EAAEA;IAC9B,CAAC,CAAC;EACN;AACJ;AACApK,OAAO,CAACE,qCAAqC,GAAGA,qCAAqC;AACrF,SAASD,sCAAsC,CAACgJ,WAAW,EAAE;EACzD,IAAInF,EAAE;EACN,IAAIoD,GAAG,GAAG,CAACpD,EAAE,GAAGmF,WAAW,CAAC,UAAU,CAAC,MAAM,IAAI,IAAInF,EAAE,KAAK,KAAK,CAAC,GAAG,KAAK,CAAC,GAAGA,EAAE,CAACsG,wBAAwB;EACzG,IAAIlD,GAAG,KAAKtD,SAAS,EAAE;IACnB,OAAOqF,WAAW,CAAC,UAAU,CAAC,CAACmB,wBAAwB;EAC3D;EACA,OAAOlD,GAAG;AACd;AACAlH,OAAO,CAACC,sCAAsC,GAAGA,sCAAsC"},"metadata":{},"sourceType":"script","externalDependencies":[]}